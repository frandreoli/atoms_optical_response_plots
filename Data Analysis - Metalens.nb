(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    196571,       4534]
NotebookOptionsPosition[    186683,       4314]
NotebookOutlinePosition[    190404,       4403]
CellTagsIndexPosition[    189991,       4389]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Atomic Metalens", "Title",
 CellChangeTimes->{{3.8218633734149523`*^9, 3.821863377088245*^9}, {
   3.883720275858762*^9, 3.8837202818557715`*^9}, 3.883814563391241*^9, 
   3.883822810474592*^9},ExpressionUUID->"9f43ea28-6d05-45db-89a7-\
4505fd0be62a"],

Cell["Data analysis", "Subtitle",
 CellChangeTimes->{{3.8838280542384405`*^9, 
  3.883828056700447*^9}},ExpressionUUID->"c74474f9-d94d-4d5c-9b16-\
01fd4f3ddd1d"],

Cell[CellGroupData[{

Cell["Initializing Functions", "Chapter",
 CellChangeTimes->{{3.7990582832212915`*^9, 3.799058285531228*^9}, {
   3.883720447011971*^9, 3.8837204722338247`*^9}, {3.8840863315793223`*^9, 
   3.884086336420348*^9}, {3.8840863957493362`*^9, 3.884086407706992*^9}, 
   3.884087007188838*^9},ExpressionUUID->"f7d62559-3c4d-43b5-8914-\
edea640f0ecd"],

Cell[CellGroupData[{

Cell["Plot Options", "Section",
 CellChangeTimes->{{3.7550967201419506`*^9, 3.7550967223764367`*^9}, {
   3.775465287847994*^9, 3.7754652888179417`*^9}, {3.7754664940653524`*^9, 
   3.7754665010190163`*^9}, {3.7754793904739976`*^9, 
   3.7754793932550535`*^9}, {3.775792195284711*^9, 3.7757921985086727`*^9}, {
   3.77643284579401*^9, 3.7764328485438204`*^9}, {3.7765919624764996`*^9, 
   3.7765919681162558`*^9}, 3.77780405425908*^9, {3.777882977433613*^9, 
   3.7778829977536592`*^9}, {3.778334521792591*^9, 3.7783345277657547`*^9}, {
   3.7784138683243437`*^9, 3.778413882965331*^9}, {3.7785782721949186`*^9, 
   3.778578273060033*^9}, {3.783062440853959*^9, 3.78306244147151*^9}, {
   3.783258420680603*^9, 
   3.783258439955716*^9}},ExpressionUUID->"646507d2-7017-46a3-8b0c-\
fc643ee761cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"frameTicksDimensions", "=", "22"}], ";", "16", ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labelsDimensions", "=", "25"}], ";", "21", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imageSizeChosen", "=", "550"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"imageSizeChosenSmaller", "=", "400"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLinePlot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", "  ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLogPlot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", " ", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Histogram", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"SmoothHistogram", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"LogPlot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ParametricPlot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLogLogPlot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLogLinearPlot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", " ", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"SmoothDensityHistogram", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosenSmaller"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListDensityPlot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosenSmaller"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"DensityPlot", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosenSmaller"}], ",", " ", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", " ", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPointPlot3D", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", "  ", 
    RowBox[{"TicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"ListPlot3D", ",", 
     RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", "  ", 
     RowBox[{"TicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
     ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListSliceDensityPlot3D", ",", 
    RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "imageSizeChosen"}], ",", "  ", 
    RowBox[{"TicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "frameTicksDimensions"}], "]"}]}], 
    ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Bold", ",", "labelsDimensions"}], "]"}]}]}], 
   "]"}], ";"}]}], "Input",
 Editable->False,
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.756017197887542*^9, 3.7560172630487895`*^9}, {
   3.756020820278768*^9, 3.756020820861129*^9}, {3.7560356023199596`*^9, 
   3.756035638043954*^9}, {3.75603567256019*^9, 3.7560356943124695`*^9}, {
   3.7560357299075875`*^9, 3.756035793412964*^9}, {3.756191839889738*^9, 
   3.756191860984183*^9}, 3.7562010999400587`*^9, {3.756201161791215*^9, 
   3.7562011628365088`*^9}, {3.7562017795342665`*^9, 3.756201787704816*^9}, {
   3.756203060687145*^9, 3.7562030705687313`*^9}, 3.7562049116550407`*^9, {
   3.756207365068405*^9, 3.7562073710085783`*^9}, {3.756369521458799*^9, 
   3.75636955760077*^9}, {3.7567346957839003`*^9, 3.756734697169958*^9}, {
   3.75679814739318*^9, 3.75679821572003*^9}, {3.757160919564146*^9, 
   3.7571609387110605`*^9}, {3.757327020715005*^9, 3.757327051536595*^9}, {
   3.757327243764428*^9, 3.7573272738705215`*^9}, {3.7576791691237197`*^9, 
   3.757679193508708*^9}, {3.7670930167301283`*^9, 3.767093019514175*^9}, {
   3.767100384655878*^9, 3.7671003926919184`*^9}, {3.767100472882896*^9, 
   3.7671004774994087`*^9}, 3.7671015509983225`*^9, {3.767429214070979*^9, 
   3.767429223445858*^9}, {3.769008170380931*^9, 3.769008175515523*^9}, {
   3.773120590402684*^9, 3.773120599513726*^9}, {3.7733981430291457`*^9, 
   3.7733981445893016`*^9}, 3.792495035341323*^9, {3.792495251353598*^9, 
   3.7924952525355177`*^9}, {3.792496328362811*^9, 3.792496328977461*^9}, {
   3.8056308431595635`*^9, 3.805630843596828*^9}, {3.805721323624217*^9, 
   3.8057213524843435`*^9}, {3.805721462519565*^9, 3.805721467586924*^9}, {
   3.8057215107488174`*^9, 3.8057215139355993`*^9}, {3.812280322899521*^9, 
   3.8122803269677095`*^9}, {3.8122803657729607`*^9, 3.812280365977421*^9}, {
   3.8200654749504747`*^9, 3.8200654954711213`*^9}, {3.8200655654918556`*^9, 
   3.8200655693947515`*^9}, {3.820065731374266*^9, 3.820065731515067*^9}, {
   3.8218675433933992`*^9, 3.821867546116843*^9}, {3.8837203260512657`*^9, 
   3.8837204072754946`*^9}, {3.8838281789138255`*^9, 
   3.8838282666613064`*^9}, {3.884267397502246*^9, 3.884267416290315*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"25c0bae5-711e-444c-9786-4c2cb5aa7176"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gaussian Beam", "Section",
 CellChangeTimes->{{3.821867952791013*^9, 3.8218679533769274`*^9}, {
  3.883720292404784*^9, 
  3.88372029346479*^9}},ExpressionUUID->"46a7c013-6c4a-4345-a39c-\
7bb9a1c6aa73"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "gauss"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gauss", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Rho]x_", ",", "\[Rho]y_", ",", "\[Rho]z_"}], "}"}], ",", 
     RowBox[{"w0_", ":", "1"}], " ", ",", 
     RowBox[{"\[Rho]z0_", ":", "0"}], ",", 
     RowBox[{"\[Lambda]0_", ":", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "w", ",", "invR", ",", "\[Phi]", ",", "r", ",", "wCurrent", ",", "x", 
       ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"\[Rho]x", ",", "\[Rho]y", ",", 
         RowBox[{"\[Rho]z", "-", "\[Rho]z0"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "^", "2"}], "]"}], "//", 
        "Sqrt"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"wCurrent", "=", 
       RowBox[{"w0", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"\[Lambda]0", " ", "z"}], 
              RowBox[{"\[Pi]", " ", 
               SuperscriptBox["w0", "2"]}]], ")"}], "2"]}], ")"}], 
         RowBox[{"1", "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"invR", " ", "=", 
       FractionBox[
        RowBox[{"z", " ", 
         SuperscriptBox["\[Lambda]0", "2"]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Pi]", "2"], " ", 
          SuperscriptBox["w0", "4"]}], "+", 
         RowBox[{
          SuperscriptBox["z", "2"], " ", 
          SuperscriptBox["\[Lambda]0", "2"]}]}]]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"-", 
        RowBox[{"ArcTan", "[", 
         FractionBox[
          RowBox[{"\[Lambda]0", " ", "z", " "}], 
          RowBox[{"\[Pi]", " ", 
           SuperscriptBox["w0", "2"]}]], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(", " ", 
       RowBox[{
        FractionBox["w0", "wCurrent"], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox["r", "2"], 
            SuperscriptBox["wCurrent", "2"]]}], "+", 
          RowBox[{"I", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               FractionBox[
                RowBox[{"2", "\[Pi]"}], "\[Lambda]0"], ")"}], 
              FractionBox[
               RowBox[{" ", 
                SuperscriptBox["r", "2"]}], 
               RowBox[{"(", "2", ")"}]], "invR"}], "+", " ", "\[Phi]", "+", 
             " ", 
             RowBox[{
              RowBox[{"(", 
               FractionBox[
                RowBox[{"2", "\[Pi]"}], "\[Lambda]0"], ")"}], " ", 
              RowBox[{"(", "z", ")"}]}]}], ")"}]}]}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8224764929889812`*^9, 3.8224765053083525`*^9}, {
   3.8227187313810616`*^9, 3.82271873172511*^9}, 3.8227187829902587`*^9, {
   3.822993643299464*^9, 3.8229936665639725`*^9}, {3.883720290500782*^9, 
   3.8837202909807825`*^9}, {3.884092277178462*^9, 3.8840923140145283`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"9d0503ef-60fc-4993-9648-224850e4d9af"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.822718650232459*^9, 3.8227186652450933`*^9}, {
  3.82271869539153*^9, 3.8227187301661253`*^9}},
 CellLabel->
  "In[1837]:=",ExpressionUUID->"63a28e6b-a612-4f30-9569-5b2f90d7dc32"]
}, Closed]],

Cell[CellGroupData[{

Cell["Overall Functions", "Section",
 CellChangeTimes->{{3.883720431435934*^9, 3.88372043426093*^9}, 
   3.883814907851996*^9},ExpressionUUID->"74af3b4b-3b25-49fc-80c4-\
34fdc569225b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rSimple", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"var", ",", "cond"}], "}"}], ",", 
    RowBox[{
     RowBox[{"var", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"Cases", "[", 
          RowBox[{"x", ",", "_Symbol", ",", "\[Infinity]"}], "]"}], "}"}], 
        "]"}], "]"}]}], ";", 
     RowBox[{"cond", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "var", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "\[Element]", 
         TemplateBox[{},
          "Reals"]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Return", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{"x", ",", 
        RowBox[{"Assumptions", "\[Rule]", "cond"}]}], "]"}], "]"}], ";"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posSimple", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"var", ",", "cond"}], "}"}], ",", 
    RowBox[{
     RowBox[{"var", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"Cases", "[", 
          RowBox[{"x", ",", "_Symbol", ",", "\[Infinity]"}], "]"}], "}"}], 
        "]"}], "]"}]}], ";", 
     RowBox[{"cond", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "var", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ">", 
         "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Return", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{"x", ",", 
        RowBox[{"Assumptions", "\[Rule]", "cond"}]}], "]"}], "]"}], ";"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sqrtSimple", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "/.", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     SuperscriptBox[
      RowBox[{"(", "f_", ")"}], "2"], "]"}], "\[Rule]", 
    "f"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fAssignSymbol", "[", 
    RowBox[{"inputString_", ",", "value_"}], "]"}], ":=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"inputString", ",", "InputForm", ",", 
     RowBox[{"Function", "[", 
      RowBox[{"name", ",", 
       RowBox[{"name", "=", "value"}], ",", "HoldAll"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"From", ":", " ", 
    RowBox[{"Quantum", " ", "Methods", " ", "with", " ", 
     RowBox[{"Matematica", "/", "Springer"}], " ", 
     RowBox[{"1994", "/", "James"}], " ", 
     RowBox[{"M", ".", "Feagin"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sqrtContract", "[", "expr_", "]"}], ":=", 
   RowBox[{"expr", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"m_", "^", "q_"}], " ", 
        RowBox[{"n_", "^", "q_"}]}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", " ", "n"}], ")"}], "^", "q"}], "/;", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"IntegerQ", "[", "m", "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"IntegerQ", "[", "n", "]"}]}]}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"m_", "^", "q_"}], " ", 
        RowBox[{"n_", "^", "p_"}]}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "/", "n"}], ")"}], "^", "q"}], "/;", 
        RowBox[{
         RowBox[{"q", "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"p", "\[Equal]", 
          RowBox[{"-", "q"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"IntegerQ", "[", "m", "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"IntegerQ", "[", "n", "]"}]}]}]}]}]}], "}"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"evalTag", "[", "tag_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "nb", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nb", "=", 
       RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NotebookFind", "[", 
       RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"folderName", "=", "\"\<\>\""}], ";"}]}], "Input",
 Editable->False,
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.8838123844513717`*^9, 3.8838124633667374`*^9}, {
  3.8838219909721203`*^9, 3.8838219925459476`*^9}, {3.8838220989288177`*^9, 
  3.883822113948209*^9}, {3.883826447542139*^9, 3.883826447884132*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"bb5da58a-b9d5-48a9-9c28-99fcb7c4bfbc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Import Functions", "Section",
 CellChangeTimes->{{3.883826015953177*^9, 
  3.883826023195202*^9}},ExpressionUUID->"44c90393-b743-4a8e-95a8-\
68038154e1f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "following", " ", "is", " ", "necessary", " ", "as", " ", 
     "mathematica", " ", "inverts", " ", "the", " ", "dimensions", " ", "of", 
     " ", "n"}], "-", 
    RowBox[{
    "dimenaional", " ", "matrices", " ", "when", " ", "importing", " ", 
     RowBox[{"from", " ", ".", "h5"}], " ", "saved", " ", "by", " ", 
     "Julia"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"transposeCheck", "[", "var_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ArrayQ", "[", "var", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Transpose", "[", 
        RowBox[{"var", ",", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"Dimensions", "[", "var", "]"}]}]}], "]"}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", "var"}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Functions", " ", "to", " ", "import", " ", "data"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H5importFull", "[", 
      RowBox[{"fileName_", ",", "folder_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"variables", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"variables", "=", 
         RowBox[{"Import", "[", 
          RowBox[{
          "folder", "<>", "\"\<\\\\\>\"", "<>", "fileName", "<>", 
           "\"\<.h5\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"transposeCheck", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{
               "folder", "<>", "\"\<\\\\\>\"", "<>", "fileName", "<>", 
                "\"\<.h5\>\""}], ",", "#"}], "]"}], "&"}], "/@", 
            "variables"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"variables", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], "->", 
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "variables", "]"}]}], "}"}]}], "]"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H5import", "[", 
      RowBox[{"fileName_", ",", "text_", ",", "folder_"}], "]"}], ":=", 
     RowBox[{"transposeCheck", "@", 
      RowBox[{"(", 
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{
         "folder", "<>", "\"\<\\\\\>\"", "<>", "fileName", "<>", 
          "\"\<.h5\>\""}], ",", "text"}], "]"}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"complexCreate", "[", 
      RowBox[{"name_", ",", "subname_", ",", "data_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"totName", ",", "dataList"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"totName", "=", 
         RowBox[{"name", "<>", "subname"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "[", "totName", "]"}], ">", "0"}], ",", 
          RowBox[{"totName", "=", 
           RowBox[{"totName", "<>", "\"\<_\>\""}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dataList", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"data", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"totName", "<>", "#"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"\"\<re\>\"", ",", "\"\<im\>\""}], "}"}]}], ")"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dataList", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"dataList", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8838292674924917`*^9, 3.883829273284475*^9}, {
  3.884060443316278*^9, 3.8840604436793184`*^9}, {3.884086298319977*^9, 
  3.884086306656294*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"5ebda78a-75d8-4381-8286-140c3b619f94"]
}, Closed]],

Cell[CellGroupData[{

Cell["Button Functions", "Section",
 CellChangeTimes->{{3.8840863112934103`*^9, 
  3.884086314215439*^9}},ExpressionUUID->"3101be78-2858-43f5-b885-\
21fb78d5ed22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bStyle", "[", "text_", "]"}], ":=", 
   RowBox[{"Style", "[", 
    RowBox[{"text", ",", "Bold", ",", "Black", ",", "16"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bSize", "=", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"400", ",", "60"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"popupStyleFunc", "[", "x_", "]"}], ":=", 
  RowBox[{"Style", "[", 
   RowBox[{"x", ",", "Bold", ",", "Black", ",", "14"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"popupStyle", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "->", 
   RowBox[{"popupStyleFunc", "[", "x", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8840896837816772`*^9, 3.88408971561543*^9}, {
  3.884089765146861*^9, 3.884089765681898*^9}, {3.8840898428941727`*^9, 
  3.8840898695701666`*^9}, {3.884090075668086*^9, 3.8840900916395617`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"637996a2-38b9-404a-98ca-1ad7c87b4c48"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Initialization", "Chapter",
 CellChangeTimes->{{3.884086341478406*^9, 3.884086346338462*^9}, {
  3.8840864400503597`*^9, 
  3.884086441444374*^9}},ExpressionUUID->"7d40dfd7-06ee-4121-9ae4-\
cf0efef6cf53"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Button", "[", 
  RowBox[{
   RowBox[{"bStyle", "@", "\"\<Initialize\>\""}], " ", ",", 
   RowBox[{"FrontEndExecute", "[", 
    RowBox[{"FrontEndToken", "[", "\"\<EvaluateInitialization\>\"", "]"}], 
    "]"}], ",", "bSize"}], "]"}]], "Input",
 Editable->False,
 CellOpen->False,
 CellChangeTimes->{{3.88408644454641*^9, 3.884086453129513*^9}, 
   3.884086534238865*^9},
 CellLabel->
  "In[645]:=",ExpressionUUID->"cd89ca5c-c4d2-42ce-8015-e9732f1cdfc8"],

Cell[BoxData[
 ButtonBox[
  StyleBox["\<\"Initialize\"\>",
   StripOnInput->False,
   LineColor->GrayLevel[0],
   FrontFaceColor->GrayLevel[0],
   BackFaceColor->GrayLevel[0],
   GraphicsColor->GrayLevel[0],
   FontSize->16,
   FontWeight->Bold,
   FontColor->GrayLevel[0]],
  Appearance->Automatic,
  ButtonFunction:>FrontEndExecute[
    FrontEndToken["EvaluateInitialization"]],
  Evaluator->Automatic,
  ImageSize->{400, 60},
  Method->"Preemptive"]], "Output",
 Editable->False,
 CellChangeTimes->{
  3.8840864539225163`*^9, 3.884086538330888*^9, {3.8840898467347727`*^9, 
   3.884089872702258*^9}},
 CellLabel->
  "Out[645]=",ExpressionUUID->"25881e22-4d73-45ed-a201-ad032dfe7829"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data Selection", "Chapter",
 CellChangeTimes->{{3.82186915380832*^9, 3.8218691553337398`*^9}, {
  3.8235304991572237`*^9, 3.823530504259697*^9}, {3.823714569458785*^9, 
  3.8237146157249255`*^9}, {3.823952691495863*^9, 3.8239527005014925`*^9}, {
  3.8243127208022385`*^9, 3.8243127227365756`*^9}, {3.831119217681651*^9, 
  3.8311192209556494`*^9}, {3.8837202688607535`*^9, 3.883720269181755*^9}, {
  3.883828985506791*^9, 
  3.8838289934907494`*^9}},ExpressionUUID->"39b225c4-02cb-4d74-b011-\
07db338dee8a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Button", "[", 
  RowBox[{
   RowBox[{"bStyle", "@", "\"\<Update Folder Names\>\""}], " ", ",", 
   RowBox[{
    RowBox[{"evalTag", "[", "\"\<User_Choice_Folders\>\"", "]"}], ";", 
    RowBox[{"evalTag", "[", "\"\<User_Choice_Data\>\"", "]"}], ";"}], ",", 
   "bSize"}], "]"}]], "Input",
 Editable->False,
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.8838286717256546`*^9, 3.8838287210536966`*^9}, {
   3.883828820767988*^9, 3.8838288411919827`*^9}, {3.883829650956732*^9, 
   3.8838297247483454`*^9}, {3.8838299025177164`*^9, 3.883829965138375*^9}, {
   3.8838946062261705`*^9, 3.883894606488206*^9}, {3.883894679567507*^9, 
   3.8838947074175434`*^9}, 3.883895025409147*^9, 3.8838951141250525`*^9, {
   3.88389520643622*^9, 3.883895206989266*^9}, {3.8838953046113987`*^9, 
   3.883895304980405*^9}, {3.883895700839407*^9, 3.8838957078804035`*^9}, {
   3.884086281286233*^9, 3.8840862834873033`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"ca969745-1461-4bd5-a63b-dbf428306a96"],

Cell[BoxData[
 ButtonBox[
  StyleBox["\<\"Update Folder Names\"\>",
   StripOnInput->False,
   LineColor->GrayLevel[0],
   FrontFaceColor->GrayLevel[0],
   BackFaceColor->GrayLevel[0],
   GraphicsColor->GrayLevel[0],
   FontSize->16,
   FontWeight->Bold,
   FontColor->GrayLevel[0]],
  Appearance->Automatic,
  ButtonFunction:>($CellContext`evalTag[
    "User_Choice_Folders"]; $CellContext`evalTag["User_Choice_Data"]; Null),
  Evaluator->Automatic,
  ImageSize->{400, 60},
  Method->"Preemptive"]], "Output",
 CellChangeTimes->{{3.8838946762995048`*^9, 3.883894707874543*^9}, 
   3.883894791903616*^9, 3.8838953094063644`*^9, 3.8838957418504486`*^9, 
   3.884059178205413*^9, 3.8840795072680235`*^9, 3.8840857829543514`*^9, 
   3.884086109633606*^9, 3.8840865393068933`*^9, 3.8840865789343815`*^9, {
   3.8840869997448206`*^9, 3.88408701060089*^9}, {3.884089850670931*^9, 
   3.8840898761103163`*^9}, 3.884094997076971*^9, 3.8840955900737*^9, 
   3.8842605119518385`*^9, 3.8842671827760344`*^9, 3.884267218068226*^9, 
   3.8842693005392857`*^9, 3.884269422598849*^9, 3.884269517143714*^9, 
   3.8844366936917286`*^9, 3.8844368725438914`*^9, 3.8846904761360016`*^9, 
   3.884753337774923*^9, 3.884754234685094*^9, 3.884756054929695*^9, 
   3.8847755016794004`*^9, 3.884781912175623*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"9fca46c7-d57b-4103-be8e-95a75040923b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"parentFolder", "=", "\"\<\>\""}], ";", "\"\<Data_Output\>\"", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bStyle", "[", "\"\<Data Folder:       \>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PopupMenu", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", 
       RowBox[{"parentFolder", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"evalTag", "[", "\"\<User_Choice_Data\>\"", "]"}], ";", 
           RowBox[{"parentFolder", "=", "#"}]}], ")"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"popupStyle", "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"FileNames", "[", 
             RowBox[{"\"\<*\>\"", ",", "\"\<\>\"", ",", "1"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"DirectoryQ", "[", "#", "]"}], "&&", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringLength", "[", "#", "]"}], "\[GreaterEqual]", 
                 " ", "15"}], ",", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "15"}], "}"}]}], "]"}], "!=", 
                 "\"\<METALENS_nAtoms\>\""}], ",", "True"}], "]"}]}], "&"}]}],
            "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ")"}], ",", 
        RowBox[{
         RowBox[{"Directory", "[", "]"}], "->", 
         RowBox[{"popupStyleFunc", "[", "\"\<Current Folder\>\"", "]"}]}]}], 
       "]"}], ",", " ", 
      RowBox[{"FieldSize", "\[Rule]", "110"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 Editable->False,
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.8838957816521215`*^9, 3.883895818882211*^9}, {
   3.883895860433345*^9, 3.8838958610084276`*^9}, {3.8840870443815556`*^9, 
   3.884087082679632*^9}, {3.884089740965231*^9, 3.8840898378009815`*^9}, {
   3.884090267532013*^9, 3.8840902678070574`*^9}, {3.884690566768156*^9, 
   3.8846905704555006`*^9}, {3.8846906475821304`*^9, 
   3.8846908296536155`*^9}, {3.8846908822491493`*^9, 
   3.8846908830011787`*^9}, {3.88469096716416*^9, 3.8846909673121557`*^9}, 
   3.8846910072151737`*^9},
 CellTags->"User_Choice_Folders",
 CellLabel->"In[40]:=",ExpressionUUID->"c62a5f1b-4583-4e58-8f8a-ca35e07611a3"],

Cell[BoxData[
 TemplateBox[{
   StyleBox["\"Data Folder:       \"", Bold, 
    GrayLevel[0], 16, StripOnInput -> False], 
   PopupMenuBox[
    Dynamic[$CellContext`parentFolder, ($CellContext`evalTag[
      "User_Choice_Data"]; $CellContext`parentFolder = #)& ], {
    "C:\\Users\\fandreoli\\Github Repos\\atoms_optical_response\\Data_Output" -> 
     StyleBox["\"Current Folder\"", Bold, 
       GrayLevel[0], 14, StripOnInput -> False]}, FieldSize -> 110]},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.8838957428574576`*^9, 3.883895819461213*^9}, 
   3.8838958617563267`*^9, 3.883895929202132*^9, 3.883895988328781*^9, {
   3.883896175673732*^9, 3.883896207919272*^9}, 3.8838962631869345`*^9, {
   3.884059178245425*^9, 3.8840591796107683`*^9}, 3.884060219066739*^9, 
   3.884079507301031*^9, 3.884085782986354*^9, 3.8840858334050093`*^9, 
   3.884086109664608*^9, 3.8840865393448925`*^9, {3.8840865789643693`*^9, 
   3.8840865819603863`*^9}, {3.8840869997768145`*^9, 3.884087010636841*^9}, {
   3.884087056466553*^9, 3.8840870831676326`*^9}, 3.8840897428563166`*^9, {
   3.884089774892138*^9, 3.884089877923417*^9}, {3.8840901082310486`*^9, 
   3.884090115493203*^9}, 3.88409026827602*^9, 3.884094997118016*^9, 
   3.884095590115698*^9, 3.8840960643683257`*^9, 3.8842605119988403`*^9, 
   3.884262070294344*^9, 3.8842644996449575`*^9, 3.884267182835101*^9, 
   3.884267218114238*^9, 3.884269300596286*^9, 3.88426942263791*^9, 
   3.884269517199612*^9, 3.8844366937367296`*^9, 3.884436872595891*^9, 
   3.8846904761749983`*^9, {3.8846906896630106`*^9, 3.8846907086338243`*^9}, 
   3.884690830443643*^9, 3.8846908834031453`*^9, {3.884690953446158*^9, 
   3.884690968525155*^9}, 3.8846910082431183`*^9, 3.884753337806923*^9, 
   3.8847534411833725`*^9, {3.884754229587093*^9, 3.8847542414331446`*^9}, 
   3.884756054967708*^9, 3.8847755017104015`*^9, 3.884781912207625*^9},
 CellTags->"User_Choice_Folders",
 CellLabel->"Out[41]=",ExpressionUUID->"e2e07a7c-4c1d-442f-94cf-50ed0572071c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"addSlash", "=", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", ">", "0"}], ",", 
       RowBox[{"#", "+", "1"}], ",", "0"}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"folderNameList", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"All", ",", "parentFolder"}], "]"}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringLength", "[", "#", "]"}], ">", 
          RowBox[{"8", "+", 
           RowBox[{"addSlash", "[", 
            RowBox[{"StringLength", "[", "parentFolder", "]"}], "]"}]}]}], 
         ")"}], "&&", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "8"}], "}"}], "+", 
            RowBox[{"addSlash", "[", 
             RowBox[{"StringLength", "[", "parentFolder", "]"}], "]"}]}]}], 
          "]"}], "==", "\"\<METALENS\>\""}]}], "&"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "folderNameList", "]"}], ">", "0"}], ",", 
     RowBox[{"folderName", "=", 
      RowBox[{"folderNameList", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"folderName", "=", "\"\<\>\""}], ";", 
      RowBox[{"folderNameList", "=", 
       RowBox[{"{", "\"\<\>\"", "}"}]}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Column", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bStyle", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<Chosen Simulation: \>\"", ",", 
         RowBox[{"PopupMenu", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "folderName", "]"}], ",", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[Rule]", 
               RowBox[{
               "popupStyleFunc", "[", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringLength", "[", "parentFolder", "]"}], ">", 
                    "0"}], "&&", 
                   RowBox[{
                    RowBox[{"StringLength", "[", "#", "]"}], ">", 
                    RowBox[{"StringLength", "[", "parentFolder", "]"}]}]}], 
                  ",", 
                  RowBox[{"StringTake", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringLength", "[", "parentFolder", "]"}], "+", 
                    "2"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "#"}], "]"}], 
                "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "&"}], 
             "/@", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "folderNameList"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
             ")"}], ",", " ", 
           RowBox[{"FieldSize", "\[Rule]", "110"}]}], 
          RowBox[{"(*", 
           RowBox[{"Max", "@", 
            RowBox[{"(", 
             RowBox[{"StringLength", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"parentFolder", "<>", "\"\</\>\"", "<>", "#"}], 
                 "&"}], "/@", "folderNameList"}], ")"}]}], ")"}]}], "*)"}], 
          "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
     "\"\<\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{"Button", "[", 
      RowBox[{
       RowBox[{"bStyle", "[", "\"\<Data Import\>\"", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", "folderName", "]"}], ">", "0"}], ",", 
         RowBox[{
          RowBox[{"evalTag", "[", "\"\<Data_Import\>\"", "]"}], ";", 
          RowBox[{"evalTag", "[", "\"\<User_Choice_Input\>\"", "]"}], ";", 
          RowBox[{"evalTag", "[", "\"\<Probe_Field_Options\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"evalTag", "[", "\"\<Probe_Field_Options_2\>\"", "]"}], 
          ";"}]}], "]"}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"400", ",", "60"}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], ",", " ", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], "Input",
 Editable->False,
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.883824806709139*^9, 3.883824938188793*^9}, {
   3.8838256166374536`*^9, 3.883825661671638*^9}, {3.883825692381833*^9, 
   3.8838257412785497`*^9}, {3.883825773840688*^9, 3.8838257971568003`*^9}, {
   3.883826050709347*^9, 3.8838260510293427`*^9}, {3.8838283917614985`*^9, 
   3.8838285754488916`*^9}, {3.883828868396683*^9, 3.883828868845639*^9}, {
   3.8838314001180277`*^9, 3.8838314619037876`*^9}, 3.8838949167823114`*^9, {
   3.8838952016532617`*^9, 3.883895204915229*^9}, {3.8838952845823374`*^9, 
   3.8838952848903766`*^9}, {3.883895637938801*^9, 3.883895685087884*^9}, {
   3.883895716995432*^9, 3.883895721439476*^9}, {3.883895901811378*^9, 
   3.883895910036409*^9}, {3.8838960452251873`*^9, 3.8838960697332697`*^9}, {
   3.884067002053353*^9, 3.884067003537369*^9}, {3.884086180933343*^9, 
   3.884086182100371*^9}, {3.884086234192587*^9, 3.8840862359196453`*^9}, {
   3.8840870763256135`*^9, 3.8840870778966155`*^9}, {3.8840899147105355`*^9, 
   3.8840899453255053`*^9}, {3.884089986112727*^9, 3.8840900550964794`*^9}, {
   3.8840900973877316`*^9, 3.884090129323391*^9}, {3.884090187714329*^9, 
   3.8840902633549676`*^9}, {3.8840947347988615`*^9, 3.884094737143825*^9}},
 CellTags->"User_Choice_Data",
 CellLabel->"In[42]:=",ExpressionUUID->"7fb10386-7b18-47ff-829b-7d36f04d5c83"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox[
      TemplateBox[{"\"Chosen Simulation: \"", 
        PopupMenuBox[
         Dynamic[$CellContext`folderName], {
         "METALENS_nAtoms461604_w4.0_gPr5.75_r10._f20._widths0.66_phase1.077_\
buffer0.20_MIRROR_2023-02-07_EXAMPLE" -> 
          StyleBox[
           "\"METALENS_nAtoms461604_w4.0_gPr5.75_r10._f20._widths0.66_phase1.\
077_buffer0.20_MIRROR_2023-02-07_EXAMPLE\"", Bold, 
            GrayLevel[0], 14, StripOnInput -> False]}, FieldSize -> 110]},
       "RowDefault"],
      StripOnInput->False,
      LineColor->GrayLevel[0],
      FrontFaceColor->GrayLevel[0],
      BackFaceColor->GrayLevel[0],
      GraphicsColor->GrayLevel[0],
      FontSize->16,
      FontWeight->Bold,
      FontColor->GrayLevel[0]]},
    {"\<\"\"\>"},
    {"\<\"\"\>"},
    {
     ButtonBox[
      StyleBox["\<\"Data Import\"\>",
       StripOnInput->False,
       LineColor->GrayLevel[0],
       FrontFaceColor->GrayLevel[0],
       BackFaceColor->GrayLevel[0],
       GraphicsColor->GrayLevel[0],
       FontSize->16,
       FontWeight->Bold,
       FontColor->GrayLevel[0]],
      Appearance->Automatic,
      ButtonFunction:>If[
       StringLength[$CellContext`folderName] > 
        0, $CellContext`evalTag["Data_Import"]; $CellContext`evalTag[
         "User_Choice_Input"]; $CellContext`evalTag[
         "Probe_Field_Options"]; $CellContext`evalTag[
         "Probe_Field_Options_2"]; Null],
      Evaluator->Automatic,
      ImageSize->{400, 60},
      Method->"Preemptive"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 Editable->False,
 CellChangeTimes->{{3.883825662119601*^9, 3.88382579785884*^9}, 
   3.883826051644392*^9, 3.883826812313447*^9, 3.883828431847574*^9, {
   3.8838284637156796`*^9, 3.8838284758586683`*^9}, {3.8838285175927277`*^9, 
   3.883828576392849*^9}, 3.883828630597*^9, {3.8838288693246603`*^9, 
   3.8838288758606944`*^9}, 3.8838289126651993`*^9, 3.883829233858388*^9, 
   3.8838292808504972`*^9, 3.8838297262883444`*^9, {3.883829971409396*^9, 
   3.883829975957389*^9}, {3.8838314191446443`*^9, 3.8838314675498157`*^9}, 
   3.883831498831519*^9, 3.883832062504063*^9, {3.883894709150545*^9, 
   3.883894727368575*^9}, {3.8838948092506905`*^9, 3.883894816195701*^9}, {
   3.883894895373813*^9, 3.8838949173393507`*^9}, 3.883895216725713*^9, 
   3.883895310742421*^9, 3.8838956401767783`*^9, {3.883895681337824*^9, 
   3.883895685494884*^9}, {3.88389574291346*^9, 3.8838958211302233`*^9}, {
   3.8838958632285028`*^9, 3.8838958697073803`*^9}, {3.8838959113573923`*^9, 
   3.883895931735139*^9}, {3.8838959883737698`*^9, 3.883896004610793*^9}, {
   3.8838960701483145`*^9, 3.8838960875350876`*^9}, {3.883896175738768*^9, 
   3.883896207973275*^9}, 3.8838962632309365`*^9, {3.8840591782814865`*^9, 
   3.884059179714857*^9}, 3.884060219117741*^9, 3.884067031357279*^9, 
   3.884079507334751*^9, 3.8840857830203524`*^9, {3.884085833496976*^9, 
   3.8840858365959797`*^9}, 3.8840861097036123`*^9, 3.8840861875665154`*^9, 
   3.8840865393929005`*^9, {3.884086579002367*^9, 3.8840865820123863`*^9}, {
   3.884086999812811*^9, 3.884087010677843*^9}, 3.8840870848296375`*^9, {
   3.8840897877260475`*^9, 3.8840897892401323`*^9}, {3.8840899358032207`*^9, 
   3.884089945743514*^9}, 3.8840900558364973`*^9, {3.8840901100661497`*^9, 
   3.8840901565589175`*^9}, {3.884090231217514*^9, 3.8840902642794495`*^9}, 
   3.884094742483877*^9, 3.884094997161972*^9, 3.8840955901627584`*^9, 
   3.8840960644373856`*^9, 3.8842605120418396`*^9, 3.884262070376295*^9, 
   3.884264499754557*^9, 3.8842671828830786`*^9, 3.884267218158218*^9, 
   3.884269300650284*^9, 3.8842694226829123`*^9, 3.8842695172457347`*^9, 
   3.88443669378273*^9, 3.884436872635891*^9, 3.8846904762129974`*^9, {
   3.8846905572322693`*^9, 3.884690562831797*^9}, {3.8846908321988115`*^9, 
   3.8846908372892838`*^9}, {3.8846908852741003`*^9, 
   3.8846908877711463`*^9}, {3.884690955133159*^9, 3.8846909695301123`*^9}, {
   3.8846910096191187`*^9, 3.8846910211171207`*^9}, 3.884753337839923*^9, {
   3.8847534412293744`*^9, 3.8847534440623727`*^9}, {3.8847542296580935`*^9, 
   3.8847542435310946`*^9}, {3.884756054979748*^9, 3.8847560594782314`*^9}, {
   3.884775501742441*^9, 3.884775505786369*^9}, 3.8847819122416325`*^9},
 CellTags->"User_Choice_Data",
 CellLabel->"Out[45]=",ExpressionUUID->"8453896c-4bdf-4c16-95d8-e51c5b138656"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data Import Functions", "Chapter",
 CellChangeTimes->{{3.8838125397339973`*^9, 3.883812545036209*^9}, {
  3.88381297352658*^9, 3.883812978629585*^9}, {3.8840949400220647`*^9, 
  3.8840949444131117`*^9}},ExpressionUUID->"dc01bc8b-ef68-4cd0-8a6e-\
12d571e5e2ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Generic", " ", "Data", " ", "Import"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"optionsList", "=", 
     RowBox[{"H5importFull", "[", 
      RowBox[{"\"\<options\>\"", ",", "folderName"}], "]"}]}], ";", 
    RowBox[{"Keys", "[", "optionsList", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"settingsList", "=", 
     RowBox[{"H5importFull", "[", 
      RowBox[{"\"\<settings\>\"", ",", "folderName"}], "]"}]}], ";", 
    RowBox[{"Keys", "[", "settingsList", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nBulk", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "w0", ",", "  ", "gammaPrime", ",", " ", "inhomBroad", ",", 
       "detuningArray", ",", "nRepetitions"}], "}"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"settingsList", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", " ", 
        RowBox[{
        "\"\<w0\>\"", ",", " ", "\"\<gamma_prime\>\"", ",", 
         "\"\<inhom_broad_std\>\"", " ", ",", "\"\<laser_detunings\>\"", ",", 
         "\"\<n_repetitions\>\""}], "}"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w0Target", ",", "z0Target"}], "}"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"settingsList", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"\"\<w0_target\>\"", ",", "\"\<z0_target\>\""}], "}"}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"inputBeamDir", ",", "inputBeamPol"}], "}"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"settingsList", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<laser_direction\>\"", ",", "\"\<field_polarization\>\""}], 
        "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nDetuning", "=", 
     RowBox[{"Length", "@", "detuningArray"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k0", "=", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "\[Lambda]0"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Transmission", " ", "Data", " ", "Import"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tANDrData", "=", 
     RowBox[{"H5importFull", "[", 
      RowBox[{"\"\<t_and_r\>\"", ",", 
       RowBox[{"folderName", "<>", "\"\</Results\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tIn", ",", "rIn"}], "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"complexCreate", "[", 
        RowBox[{"#", ",", "\"\<_in\>\"", ",", "tANDrData"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<t\>\"", ",", "\"\<r\>\""}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"optionsList", "[", "\"\<target_beam_option\>\"", "]"}], "==", 
       "\"\<YES\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tTarget", ",", "rTarget"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"complexCreate", "[", 
          RowBox[{"#", ",", "\"\<_target\>\"", ",", "tANDrData"}], "]"}], 
         "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"\"\<t\>\"", ",", "\"\<r\>\""}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Probe", " ", "Data", " ", "Import"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nameProbes", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<XY\>\"", ",", "\"\<YZ\>\"", ",", "\"\<XZ\>\"", ",", 
       "\"\<SPHERE\>\"", ",", "\"\<PLANE\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"probeField", "[", "]"}], "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"probePos", "[", "]"}], "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"probeNormal", "[", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"funcPROBE", "[", "nameProbe_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "optionEvaluate", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"optionEvaluate", "=", 
         RowBox[{"optionsList", "[", 
          RowBox[{
          "\"\<probe\>\"", "<>", "nameProbe", "<>", "\"\<_option\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"optionEvaluate", "!=", "\"\<NO\>\""}], "&&", 
           RowBox[{"optionEvaluate", "!=", "\"\<NONE\>\""}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"probeField", "[", "nameProbe", "]"}], "=", 
            RowBox[{"complexCreate", "[", 
             RowBox[{"\"\<probe_field_\>\"", ",", "nameProbe", ",", 
              RowBox[{"H5importFull", "[", 
               RowBox[{"\"\<probe_field\>\"", ",", 
                RowBox[{"folderName", "<>", "\"\</Results\>\""}]}], "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"probePos", "[", "nameProbe", "]"}], "=", 
            RowBox[{
             RowBox[{"H5importFull", "[", 
              RowBox[{"\"\<probe_positions\>\"", ",", 
               RowBox[{"folderName", "<>", "\"\</Results\>\""}]}], "]"}], "[", 
             RowBox[{"\"\<probe_pos_\>\"", "<>", "nameProbe"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nameProbe", "==", "\"\<XY\>\""}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"probeNormal", "[", "nameProbe", "]"}], "=", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", 
              RowBox[{
               RowBox[{"probeAxisNames", "[", "nameProbe", "]"}], "=", 
               RowBox[{"{", 
                RowBox[{
                "\"\<x/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\"", ",", 
                 "\"\<y/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nameProbe", "==", "\"\<YZ\>\""}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"probeNormal", "[", "nameProbe", "]"}], "=", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";", 
              RowBox[{
               RowBox[{"probeAxisNames", "[", "nameProbe", "]"}], "=", 
               RowBox[{"Reverse", "@", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<y/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\"", ",", 
                  "\"\<z/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                 "}"}]}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nameProbe", "==", "\"\<XZ\>\""}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"probeNormal", "[", "nameProbe", "]"}], "=", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", 
              RowBox[{
               RowBox[{"probeAxisNames", "[", "nameProbe", "]"}], "=", 
               RowBox[{"{", 
                RowBox[{
                "\"\<x/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\"", ",", 
                 "\"\<z/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                "}"}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nameProbe", "==", "\"\<PLANE\>\""}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"probeNormal", "[", "nameProbe", "]"}], "=", 
               RowBox[{"H5import", "[", 
                RowBox[{
                "\"\<settings\>\"", ",", "\"\<probePlane_vec\>\"", ",", 
                 "folderName"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"probeAxisNames", "[", "nameProbe", "]"}], "=", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(v\), \(1\)]\)/\!\(\*SubscriptBox[\(\
\[Lambda]\), \(0\)]\)\>\"", ",", 
                 "\"\<\!\(\*SubscriptBox[\(v\), \
\(2\)]\)/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], "}"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"funcPROBE", "[", "#", "]"}], "&"}], "/@", "nameProbes"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Metalens", " ", "Data", " ", "Import"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"settingsMetalensList", "=", 
     RowBox[{"H5importFull", "[", 
      RowBox[{"\"\<settings_metalens\>\"", ",", "folderName"}], "]"}]}], ";", 
    RowBox[{"Keys", "[", "settingsMetalensList", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "rLens", ",", " ", "focalPoint", ",", " ", "nPhaseDisks", ",", 
       "bufferRange", ",", "lensDisksR", ",", "latticeConstantsDisks"}], 
      "}"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"settingsMetalensList", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<r_lens\>\"", ",", "\"\<focal_length\>\"", ",", 
         "\"\<n_phase_disks\>\"", ",", "\"\<buffer_smooth\>\"", ",", 
         "\"\<lens_disks_r\>\"", ",", "\"\<lattice_array\>\""}], "}"}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"optionsMetalensList", "=", 
     RowBox[{"H5importFull", "[", 
      RowBox[{"\"\<options_metalens\>\"", ",", "folderName"}], "]"}]}], ";", 
    RowBox[{"Keys", "[", "optionsMetalensList", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"optionsList", "[", "\"\<pos_save_option\>\"", "]"}], "==", 
       "\"\<YES\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"posAtoms", "=", 
        RowBox[{"H5import", "[", " ", 
         RowBox[{
         "\"\<atomic_positions\>\"", ",", "\"\</r_atoms\>\"", ",", 
          "folderName"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", "posAtoms", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"magnificationTheo", "=", 
     FractionBox["focalPoint", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox["focalPoint", "2"], "+", 
        RowBox[{
         SuperscriptBox["k0", "2"], 
         RowBox[{
          SuperscriptBox["w0", "4"], "/", "4"}]}]}], "]"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w0Ideal", "=", 
     RowBox[{"magnificationTheo", "*", "w0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z0Ideal", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["magnificationTheo", "2"]}], ")"}], "focalPoint"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 Editable->False,
 CellOpen->False,
 CellChangeTimes->{{3.8838125390900273`*^9, 3.8838125481822486`*^9}, {
   3.8838126667206945`*^9, 3.883812718168344*^9}, {3.8838127892212896`*^9, 
   3.883812827029176*^9}, {3.8838129120971575`*^9, 3.8838129298252735`*^9}, {
   3.8838129650024986`*^9, 3.8838129709895353`*^9}, {3.8838130098663425`*^9, 
   3.883813144951902*^9}, 3.8838136058785257`*^9, {3.8838142095609426`*^9, 
   3.883814210470885*^9}, {3.8838242075438676`*^9, 3.8838242251812105`*^9}, {
   3.8838243880159254`*^9, 3.883824392113042*^9}, {3.8838245031618958`*^9, 
   3.8838245153977647`*^9}, 3.883824657323738*^9, {3.8838259820884466`*^9, 
   3.8838259839054475`*^9}, {3.8838262294141626`*^9, 
   3.8838262417602434`*^9}, {3.8840605068980536`*^9, 
   3.8840605632087374`*^9}, {3.884066920478637*^9, 3.8840669218446503`*^9}, 
   3.8840669638130713`*^9, {3.884093173182148*^9, 3.884093243301118*^9}, {
   3.884264966687654*^9, 3.8842649877025695`*^9}, {3.8842695502743587`*^9, 
   3.8842696308414555`*^9}, 3.8844368390244274`*^9, {3.884754380206967*^9, 
   3.884754382591968*^9}, {3.8847550007026553`*^9, 3.8847550014167004`*^9}, {
   3.8847729911015377`*^9, 3.8847729922572584`*^9}},
 CellTags->"Data_Import",
 CellLabel->"In[52]:=",ExpressionUUID->"925f65a4-5d21-4928-b99b-c52836936a4f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chosenDetuningIndex", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chosenRepetition", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Style", "[", 
  RowBox[{
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Insert here the choice of detuning:   \>\"", ",", "Red"}],
        "]"}], ",", 
      RowBox[{"InputField", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", 
         RowBox[{"chosenDetuningIndex", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
               RowBox[{
               "1", "\[LessEqual]", "#", "\[LessEqual]", " ", "nDetuning"}]}],
               ")"}], ",", 
             RowBox[{"chosenDetuningIndex", "=", "#"}], ",", 
             RowBox[{"chosenDetuningIndex", "=", "1"}]}], "]"}], " ", "&"}]}],
          "]"}], ",", "Number", ",", 
        RowBox[{"FieldSize", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"Length", "@", 
           RowBox[{"IntegerDigits", "[", "nDetuning", "]"}]}], ")"}]}]}], 
       "]"}], ",", "\"\< / \>\"", ",", "nDetuning", ",", " ", 
      "\"\<      \[RightArrow]     \[CapitalDelta] / \!\(\*SubscriptBox[\(\
\[CapitalGamma]\), \(0\)]\) = \>\"", ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ValueQ", "[", "detuningArray", "]"}], ",", 
         RowBox[{"detuningArray", "[", 
          RowBox[{"[", "chosenDetuningIndex", "]"}], "]"}]}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "]"}], ",", "  ", 
   "Bold", ",", "15"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Style", "[", 
  RowBox[{
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Insert here the choice of repetition: \>\"", ",", "Red"}],
        "]"}], ",", 
      RowBox[{"InputField", "[", 
       RowBox[{
        RowBox[{"Dynamic", "[", 
         RowBox[{"chosenRepetition", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
               RowBox[{
               "1", "\[LessEqual]", "#", "\[LessEqual]", " ", 
                "nRepetitions"}]}], ")"}], ",", 
             RowBox[{"chosenRepetition", "=", "#"}], ",", 
             RowBox[{"chosenRepetition", "=", "1"}]}], "]"}], "&"}]}], "]"}], 
        ",", "Number", ",", 
        RowBox[{"FieldSize", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"Length", "@", 
           RowBox[{"IntegerDigits", "[", "nRepetitions", "]"}]}], ")"}]}]}], 
       "]"}], ",", "\"\< / \>\"", ",", "nRepetitions"}], "}"}], "]"}], ",", 
   " ", "Black", ",", " ", "Bold", ",", "15"}], "]"}]}], "Input",
 Editable->False,
 CellOpen->False,
 CellChangeTimes->{{3.8838230039727573`*^9, 3.88382301657511*^9}, {
  3.883823222512791*^9, 3.8838232250359287`*^9}, {3.88382326275965*^9, 
  3.883823294817706*^9}, {3.883823349348052*^9, 3.8838233741367273`*^9}, {
  3.883823615620097*^9, 3.8838236177943335`*^9}, {3.883824192229805*^9, 
  3.8838241940723553`*^9}, {3.8838242330239005`*^9, 3.8838242500616236`*^9}, {
  3.883824373606198*^9, 3.8838244504811897`*^9}, {3.8838245207771444`*^9, 
  3.8838245979576073`*^9}, {3.883825349604422*^9, 3.883825353255441*^9}, {
  3.883825502799283*^9, 3.8838255683902454`*^9}, {3.8838258584536996`*^9, 
  3.8838259279820547`*^9}, {3.8838262882556057`*^9, 3.8838263085227165`*^9}, {
  3.88383160570731*^9, 3.8838316577026973`*^9}, {3.883831696447768*^9, 
  3.883831730038789*^9}, {3.8838317919989448`*^9, 3.8838318009469814`*^9}, {
  3.883831984741748*^9, 3.8838320550010405`*^9}},
 CellTags->"User_Choice_Input",
 CellLabel->"In[77]:=",ExpressionUUID->"eaa9b4e5-630c-4972-9c98-2112d2f76cc5"],

Cell[BoxData[
 StyleBox[
  TemplateBox[{
    StyleBox["\"Insert here the choice of detuning:   \"", 
     RGBColor[1, 0, 0], StripOnInput -> False], 
    InputFieldBox[
     Dynamic[$CellContext`chosenDetuningIndex, If[
       And[
        IntegerQ[#], 
        1 <= # <= $CellContext`nDetuning], $CellContext`chosenDetuningIndex = \
#, $CellContext`chosenDetuningIndex = 1]& ], Number, FieldSize -> 1], 
    "\" / \"", "1", 
    "\"      \[RightArrow]     \[CapitalDelta] / \\!\\(\\*SubscriptBox[\\(\
\[CapitalGamma]\\), \\(0\\)]\\) = \"", 
    DynamicBox[
     ToBoxes[
      If[
       ValueQ[$CellContext`detuningArray], 
       Part[$CellContext`detuningArray, $CellContext`chosenDetuningIndex]], 
      StandardForm]]},
   "RowDefault"],
  StripOnInput->False,
  FontSize->15,
  FontWeight->Bold]], "Output",
 CellChangeTimes->{{3.883823263121941*^9, 3.8838232952517223`*^9}, {
   3.8838233531734605`*^9, 3.8838233746381435`*^9}, {3.8838242365723248`*^9, 
   3.8838242505755787`*^9}, {3.883824374740018*^9, 3.8838244377293515`*^9}, 
   3.883824522671968*^9, {3.883824593516863*^9, 3.8838245986744027`*^9}, {
   3.8838255361551037`*^9, 3.8838255690192413`*^9}, 3.8838256537546115`*^9, 
   3.8838258127229195`*^9, 3.883825886221799*^9, 3.883825929949008*^9, {
   3.8838262432652016`*^9, 3.883826308901717*^9}, 3.8838268269574833`*^9, 
   3.883827231817751*^9, 3.8838284439135447`*^9, 3.8838285828148594`*^9, 
   3.88382863403298*^9, {3.883828794008627*^9, 3.8838288112359324`*^9}, 
   3.883829240308409*^9, 3.8838292832524953`*^9, 3.8838314688897924`*^9, {
   3.8838315038815093`*^9, 3.883831526401125*^9}, {3.883831658496698*^9, 
   3.883831700609733*^9}, 3.8838317307268324`*^9, 3.883831761838852*^9, 
   3.883831802073928*^9, 3.8838320661620197`*^9, 3.8838948203367257`*^9, 
   3.883894880673791*^9, 3.8838949209373055`*^9, {3.8838960001327367`*^9, 
   3.883896005715809*^9}, {3.883896089942049*^9, 3.8838961185180864`*^9}, 
   3.884059189514709*^9, 3.8840602230967493`*^9, 3.88406030373258*^9, 
   3.8840605078740115`*^9, 3.8840605546110725`*^9, 3.8840669239036713`*^9, {
   3.884067033811776*^9, 3.884067056719653*^9}, 3.884079516433669*^9, 
   3.8840839649702635`*^9, 3.8840848173020525`*^9, 3.8840858668530197`*^9, 
   3.884085975148398*^9, 3.884086121520917*^9, {3.884086189919574*^9, 
   3.8840862238284645`*^9}, 3.884086589705429*^9, 3.884088350653949*^9, 
   3.8840947464858522`*^9, 3.8840950064339952`*^9, 3.8840955943402133`*^9, 
   3.884095739269373*^9, 3.8840960282296686`*^9, 3.884096090602803*^9, 
   3.8842620833770065`*^9, 3.8842645092809715`*^9, 3.8842649934326773`*^9, 
   3.884267230522187*^9, 3.884267422341278*^9, 3.8842674693233385`*^9, 
   3.8842677525057106`*^9, 3.8842685577843165`*^9, {3.8842693131903467`*^9, 
   3.8842693290963697`*^9}, 3.8842694830449266`*^9, 3.8842695318372793`*^9, {
   3.8842696672024727`*^9, 3.884269675333482*^9}, {3.884436719094514*^9, 
   3.8844367398185663`*^9}, 3.884436878885906*^9, 3.8847534483173738`*^9, 
   3.8847542473000956`*^9, 3.8847560617014065`*^9, 3.884775510114438*^9, 
   3.8847819235501957`*^9},
 CellTags->"User_Choice_Input",
 CellLabel->"Out[79]=",ExpressionUUID->"904ba43d-3c2b-4058-86e1-a8a89cc46e1f"],

Cell[BoxData[
 StyleBox[
  TemplateBox[{
    StyleBox["\"Insert here the choice of repetition: \"", 
     RGBColor[1, 0, 0], StripOnInput -> False], 
    InputFieldBox[
     Dynamic[$CellContext`chosenRepetition, If[
       And[
        IntegerQ[#], 
        1 <= # <= $CellContext`nRepetitions], $CellContext`chosenRepetition = \
#, $CellContext`chosenRepetition = 1]& ], Number, FieldSize -> 1], "\" / \"", 
    "1"},
   "RowDefault"],
  StripOnInput->False,
  LineColor->GrayLevel[0],
  FrontFaceColor->GrayLevel[0],
  BackFaceColor->GrayLevel[0],
  GraphicsColor->GrayLevel[0],
  FontSize->15,
  FontWeight->Bold,
  FontColor->GrayLevel[0]]], "Output",
 CellChangeTimes->{{3.883823263121941*^9, 3.8838232952517223`*^9}, {
   3.8838233531734605`*^9, 3.8838233746381435`*^9}, {3.8838242365723248`*^9, 
   3.8838242505755787`*^9}, {3.883824374740018*^9, 3.8838244377293515`*^9}, 
   3.883824522671968*^9, {3.883824593516863*^9, 3.8838245986744027`*^9}, {
   3.8838255361551037`*^9, 3.8838255690192413`*^9}, 3.8838256537546115`*^9, 
   3.8838258127229195`*^9, 3.883825886221799*^9, 3.883825929949008*^9, {
   3.8838262432652016`*^9, 3.883826308901717*^9}, 3.8838268269574833`*^9, 
   3.883827231817751*^9, 3.8838284439135447`*^9, 3.8838285828148594`*^9, 
   3.88382863403298*^9, {3.883828794008627*^9, 3.8838288112359324`*^9}, 
   3.883829240308409*^9, 3.8838292832524953`*^9, 3.8838314688897924`*^9, {
   3.8838315038815093`*^9, 3.883831526401125*^9}, {3.883831658496698*^9, 
   3.883831700609733*^9}, 3.8838317307268324`*^9, 3.883831761838852*^9, 
   3.883831802073928*^9, 3.8838320661620197`*^9, 3.8838948203367257`*^9, 
   3.883894880673791*^9, 3.8838949209373055`*^9, {3.8838960001327367`*^9, 
   3.883896005715809*^9}, {3.883896089942049*^9, 3.8838961185180864`*^9}, 
   3.884059189514709*^9, 3.8840602230967493`*^9, 3.88406030373258*^9, 
   3.8840605078740115`*^9, 3.8840605546110725`*^9, 3.8840669239036713`*^9, {
   3.884067033811776*^9, 3.884067056719653*^9}, 3.884079516433669*^9, 
   3.8840839649702635`*^9, 3.8840848173020525`*^9, 3.8840858668530197`*^9, 
   3.884085975148398*^9, 3.884086121520917*^9, {3.884086189919574*^9, 
   3.8840862238284645`*^9}, 3.884086589705429*^9, 3.884088350653949*^9, 
   3.8840947464858522`*^9, 3.8840950064339952`*^9, 3.8840955943402133`*^9, 
   3.884095739269373*^9, 3.8840960282296686`*^9, 3.884096090602803*^9, 
   3.8842620833770065`*^9, 3.8842645092809715`*^9, 3.8842649934326773`*^9, 
   3.884267230522187*^9, 3.884267422341278*^9, 3.8842674693233385`*^9, 
   3.8842677525057106`*^9, 3.8842685577843165`*^9, {3.8842693131903467`*^9, 
   3.8842693290963697`*^9}, 3.8842694830449266`*^9, 3.8842695318372793`*^9, {
   3.8842696672024727`*^9, 3.884269675333482*^9}, {3.884436719094514*^9, 
   3.8844367398185663`*^9}, 3.884436878885906*^9, 3.8847534483173738`*^9, 
   3.8847542473000956`*^9, 3.8847560617014065`*^9, 3.884775510114438*^9, 
   3.8847819235541945`*^9},
 CellTags->"User_Choice_Input",
 CellLabel->"Out[80]=",ExpressionUUID->"bf46e87c-9b55-43fa-b92f-8ca9056c0794"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Probe Field Plots", "Chapter",
 CellChangeTimes->{{3.8840826438057795`*^9, 3.8840826508638945`*^9}, {
  3.884082748948583*^9, 3.884082751850294*^9}, {3.884082954160387*^9, 
  3.884082954877221*^9}},ExpressionUUID->"39fc1664-ba47-44c3-a233-\
4b56ef15cf23"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Probe: \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"#", ",", "Red"}], "]"}]}], "}"}], "]"}], ",", "Black",
            ",", "15", ",", "Bold"}], "]"}], "&"}], "/@", 
        "nameProbesSelected"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"\"\<      Polarization to plot:\>\"", ",", 
         RowBox[{"Length", "[", "nameProbesSelected", "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PopupMenu", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"iNameHere", "=", "iName"}], "}"}], ",", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"probePolOption", "[", "iNameHere", "]"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\"", ",", 
             "\"\<total\>\""}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"iName", ",", "nameProbesSelected"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"\"\<      Field/Intensity\>\"", ",", 
         RowBox[{"Length", "[", "nameProbesSelected", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PopupMenu", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"iNameHere", "=", "iName"}], "}"}], ",", 
             RowBox[{"Dynamic", "[", 
              RowBox[{"probeFieldIntOption", "[", "iNameHere", "]"}], "]"}]}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<|Re(E)|\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\)\>\"", ",", 
             " ", "\"\<|E|\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\)\>\""}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"iName", ",", "nameProbesSelected"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
    RowBox[{"Spacings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ",", 
    RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "*)"}]], "Input",
 Editable->False,
 CellOpen->False,ExpressionUUID->"dc36c839-f4d2-486a-a5de-9081f8daab88"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nameProbes", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<XY\>\"", ",", "\"\<YZ\>\"", ",", "\"\<XZ\>\"", ",", "\"\<SPHERE\>\"",
      ",", "\"\<PLANE\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"optionEvaluateProbes", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", "==", "\"\<NONE\>\""}], ",", "\"\<NO\>\"", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "!=", "\"\<NO\>\""}], "&&", 
              RowBox[{"#", "!=", "\"\<YES\>\""}]}], ",", "\"\<YES\>\"", ",", 
             "#"}], "]"}]}], "]"}], "&"}], ")"}], "@", 
       RowBox[{"optionsList", "[", 
        RowBox[{"\"\<probe\>\"", "<>", "#", "<>", "\"\<_option\>\""}], 
        "]"}]}], ")"}], "&"}], "/@", "nameProbes"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nameProbesSelected", "=", 
    RowBox[{"nameProbes", "[", 
     RowBox[{"[", 
      RowBox[{"Select", "[", " ", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "@", "nameProbes"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"optionEvaluateProbes", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "==", "\"\<YES\>\""}], "&"}]}], 
       "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "nameProbesSelected", "]"}], "\[GreaterEqual]", 
     " ", "1"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iNameHere", "=", 
      RowBox[{"nameProbesSelected", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"probePolOptionHere", "=", "\"\<total\>\""}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bStyle", "[", "\"\<Chosen probe surface: \>\"", "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"PopupMenu", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "iNameHere", "]"}], ",", 
             RowBox[{"popupStyle", "/@", "nameProbesSelected"}]}], "]"}]}], 
          "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"bStyle", "[", "\"\<Polarization to plot: \>\"", "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"PopupMenu", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", 
              RowBox[{"probePolOptionHere", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "evalTag", "[", "\"\<Probe_Field_Options_2\>\"", "]"}], ";", 
                  RowBox[{"probePolOptionHere", "=", "#"}]}], ")"}], "&"}]}], 
              "]"}], ",", 
             RowBox[{"popupStyle", "/@", 
              RowBox[{"{", 
               RowBox[{
               "\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\"", ",", 
                "\"\<total\>\""}], "}"}]}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "}"}], ",", " ", 
       RowBox[{"Alignment", "\[Rule]", "Left"}], ",", " ", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"4", ",", "1"}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalTag", "[", "\"\<Probe_Field_Options_2\>\"", "]"}], 
  "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 Editable->False,
 CellOpen->False,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQfUeZ/aPPhzeOby7PBNM38qR+gehjP6fz+ALpW0If
JED0n41WoSA6aOuGKBDtVigTA6K3OP/KAtHu2s+qQbTdi10NILrB2rgZRC+Z
6dEBogvy7GeA6GUr3i8A0VHX7+wD0UoNZmdB9L/0tHMgWuFZwjUQ/Ygz4QGI
zjkcIugHpNNeBQqBaJnrn8tAtMCarCoQPU8m9hWI3iSXA6bV4+zfgehtd7o4
/IG0uegLQRCd7pAtAqKFGhiNQHSNyQ9TEJ0m+ngmiL5xbNV2EC0zZfIeEF3n
m3gCRDNcMzwPop8wLQHTHY2BV0D0n3mPb4NoaQmORyDaekGYUACQvtSQLQ6i
w98XSINot83/ykD0uyOhVSAaAFB0zlg=
  "],
 CellTags->"Probe_Field_Options",
 CellLabel->"In[81]:=",ExpressionUUID->"5f02d3f8-521e-4778-ad5d-1e72e1c067f9"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"Chosen probe surface: \"\>",
      StripOnInput->False,
      LineColor->GrayLevel[0],
      FrontFaceColor->GrayLevel[0],
      BackFaceColor->GrayLevel[0],
      GraphicsColor->GrayLevel[0],
      FontSize->16,
      FontWeight->Bold,
      FontColor->GrayLevel[0]], 
     PopupMenuBox[Dynamic[$CellContext`iNameHere], {"XY"->
      StyleBox["\<\"XY\"\>",
       StripOnInput->False,
       LineColor->GrayLevel[0],
       FrontFaceColor->GrayLevel[0],
       BackFaceColor->GrayLevel[0],
       GraphicsColor->GrayLevel[0],
       FontSize->14,
       FontWeight->Bold,
       FontColor->GrayLevel[0]], "YZ"->
      StyleBox["\<\"YZ\"\>",
       StripOnInput->False,
       LineColor->GrayLevel[0],
       FrontFaceColor->GrayLevel[0],
       BackFaceColor->GrayLevel[0],
       GraphicsColor->GrayLevel[0],
       FontSize->14,
       FontWeight->Bold,
       FontColor->GrayLevel[0]], "XZ"->
      StyleBox["\<\"XZ\"\>",
       StripOnInput->False,
       LineColor->GrayLevel[0],
       FrontFaceColor->GrayLevel[0],
       BackFaceColor->GrayLevel[0],
       GraphicsColor->GrayLevel[0],
       FontSize->14,
       FontWeight->Bold,
       FontColor->GrayLevel[0]]}]},
    {
     StyleBox["\<\"Polarization to plot: \"\>",
      StripOnInput->False,
      LineColor->GrayLevel[0],
      FrontFaceColor->GrayLevel[0],
      BackFaceColor->GrayLevel[0],
      GraphicsColor->GrayLevel[0],
      FontSize->16,
      FontWeight->Bold,
      FontColor->GrayLevel[0]], 
     PopupMenuBox[
      Dynamic[$CellContext`probePolOptionHere, ($CellContext`evalTag[
        "Probe_Field_Options_2"]; $CellContext`probePolOptionHere = #)& ], {
      "x"->
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       LineColor->GrayLevel[0],
       FrontFaceColor->GrayLevel[0],
       BackFaceColor->GrayLevel[0],
       GraphicsColor->GrayLevel[0],
       FontSize->14,
       FontWeight->Bold,
       FontColor->GrayLevel[0]], "y"->
      StyleBox["\<\"y\"\>",
       StripOnInput->False,
       LineColor->GrayLevel[0],
       FrontFaceColor->GrayLevel[0],
       BackFaceColor->GrayLevel[0],
       GraphicsColor->GrayLevel[0],
       FontSize->14,
       FontWeight->Bold,
       FontColor->GrayLevel[0]], "z"->
      StyleBox["\<\"z\"\>",
       StripOnInput->False,
       LineColor->GrayLevel[0],
       FrontFaceColor->GrayLevel[0],
       BackFaceColor->GrayLevel[0],
       GraphicsColor->GrayLevel[0],
       FontSize->14,
       FontWeight->Bold,
       FontColor->GrayLevel[0]], "total"->
      StyleBox["\<\"total\"\>",
       StripOnInput->False,
       LineColor->GrayLevel[0],
       FrontFaceColor->GrayLevel[0],
       BackFaceColor->GrayLevel[0],
       GraphicsColor->GrayLevel[0],
       FontSize->14,
       FontWeight->Bold,
       FontColor->GrayLevel[0]]}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxSpacings->{"Columns" -> {{4}}, "Rows" -> {{1}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.884083271683919*^9, 3.884083302016692*^9, 3.8840834244573975`*^9, 
   3.884083459276485*^9, {3.884083498649273*^9, 3.884083536122201*^9}, {
   3.884083580955677*^9, 3.884083646384612*^9}, 3.884083700854868*^9, {
   3.8840837380476313`*^9, 3.8840838161997623`*^9}, {3.8840838604691544`*^9, 
   3.8840838836468487`*^9}, 3.8840839381360254`*^9, 3.884083987436889*^9, 
   3.884084110157718*^9, {3.884084185805047*^9, 3.884084191837078*^9}, {
   3.8840842981456575`*^9, 3.884084346317677*^9}, {3.8840843931702766`*^9, 
   3.884084418455284*^9}, 3.884084492826644*^9, {3.8840845721454067`*^9, 
   3.8840845771274376`*^9}, {3.8840846344658613`*^9, 
   3.8840846367468767`*^9}, {3.884084676374263*^9, 3.8840847272456903`*^9}, {
   3.8840848053694563`*^9, 3.884084851613594*^9}, {3.8840849285992465`*^9, 
   3.8840849954992027`*^9}, {3.8840859588704677`*^9, 
   3.8840859751874094`*^9}, {3.884086189976575*^9, 3.884086223907464*^9}, {
   3.8840865897564273`*^9, 3.8840865898174295`*^9}, 3.8840871583442545`*^9, 
   3.884087331608814*^9, 3.8840873652924395`*^9, {3.884087442620631*^9, 
   3.8840874636316195`*^9}, {3.8840874951550045`*^9, 3.884087496685008*^9}, 
   3.884088350705949*^9, 3.884088841347653*^9, 3.8840888996547084`*^9, {
   3.8840889450258884`*^9, 3.8840889577243385`*^9}, 3.8840890591911554`*^9, {
   3.884089390986229*^9, 3.8840894016362505`*^9}, 3.8840894911910534`*^9, {
   3.884089536381292*^9, 3.884089564599245*^9}, {3.8840902967443967`*^9, 
   3.8840903237272635`*^9}, 3.8840947465498514`*^9, 3.8840950065079937`*^9, 
   3.8840955943922153`*^9, 3.8840957393282924`*^9, 3.884096028284669*^9, 
   3.884096090663803*^9, 3.8842620834380074`*^9, 3.8842645093395877`*^9, 
   3.884264993483941*^9, 3.884267230594186*^9, 3.8842674223992796`*^9, 
   3.8842674693633385`*^9, 3.8842677525547686`*^9, 3.884268557825317*^9, {
   3.8842693132693467`*^9, 3.884269329135428*^9}, 3.884269483123928*^9, 
   3.8842695319172792`*^9, {3.884269667251472*^9, 3.884269675389482*^9}, {
   3.8844367191595135`*^9, 3.8844367398645678`*^9}, 3.8844368789629073`*^9, 
   3.8847534483883753`*^9, 3.884754247376095*^9, 3.884756061776413*^9, 
   3.884775510180436*^9, 3.8847819236191945`*^9},
 CellTags->"Probe_Field_Options",
 CellLabel->"Out[84]=",ExpressionUUID->"6f4674f8-d2ff-4888-a549-aad10e3fd979"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"subsProbeFieldIntOption", "[", "xx_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "\[Rule]", 
        RowBox[{"popupStyleFunc", "[", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"xx", "==", "\"\<total\>\""}], ",", "\[IndentingNewLine]", 
           "\"\<|E|\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\)\>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<| \>\"", ",", 
              RowBox[{"OverHat", "[", "xx", "]"}], ",", 
              "\"\<\[CenterDot]E |\!\(\*SuperscriptBox[\(\\\ \), \
\(2\)]\)\>\""}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"xx", "!=", "\"\<total\>\""}], ",", 
         RowBox[{"2", "\[Rule]", 
          RowBox[{"popupStyleFunc", "@", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<| re( \>\"", ",", 
              RowBox[{"OverHat", "[", "xx", "]"}], ",", 
              "\"\<\[CenterDot]E ) |\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\)\>\
\""}], "}"}], "]"}]}]}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "nameProbesSelected", "]"}], "\[GreaterEqual]", 
     " ", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"idealLensOptionHere", "=", "True"}], ";", "\[IndentingNewLine]",
      " ", 
     RowBox[{"probeFieldIntOptionHere", "=", "1"}], ";", 
     "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Field or intensity: \>\"", ",", "Bold", ",", "Black", ",", 
             "15"}], "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"PopupMenu", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Dynamic", "[", "probeFieldIntOptionHere", "]"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
             "subsProbeFieldIntOption", "[", "probePolOptionHere", "]"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"1", "\[Rule]", 
                 RowBox[{"popupStyleFunc", "[", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"probePolOptionHere", "==", "\"\<total\>\""}], 
                    ",", "\[IndentingNewLine]", 
                    "\"\<|E|\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\)\>\"", ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<| \>\"", ",", 
                    RowBox[{"OverHat", "[", "probePolOptionHere", "]"}], ",", 
                    "\"\<\[CenterDot]E |\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\
\)\>\""}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"probePolOptionHere", "!=", "\"\<total\>\""}], ",", 
                  RowBox[{"2", "\[Rule]", 
                   RowBox[{"popupStyleFunc", "@", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<| re( \>\"", ",", 
                    RowBox[{"OverHat", "[", "probePolOptionHere", "]"}], ",", 
                    "\"\<\[CenterDot]E ) |\!\(\*SuperscriptBox[\(\\\ \), \
\(2\)]\)\>\""}], "}"}], "]"}]}]}], ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
               "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}], 
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", " ", "]"}]}], "}"}],
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Ideal lens comparison: \>\"", ",", "Bold", ",", "Black", ",",
              "15"}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Checkbox", "[", 
            RowBox[{"Dynamic", "[", "idealLensOptionHere", "]"}], "]"}]}], 
          "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", " ", 
       RowBox[{"Alignment", "\[Rule]", "Left"}], ",", " ", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"4", ",", "1"}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probePlotsFunc", "[", 
    RowBox[{
    "iName_", ",", "probePolOption_", ",", "probeFieldIntOption_", ",", 
     "idealLensOption_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rotProbe", ",", "addFunc", ",", "polIndex", ",", "probeFieldHERE", ",",
        " ", "fieldToPlot", ",", " ", "rotatedProbe", ",", "colorFunc", ",", 
       "maxVal", ",", "maxValStep", ",", "styleHereLeg", ",", "legendFunc", 
       ",", "finalPlot", ",", "idealPlot", ",", " ", "idealData", ",", " ", 
       "idealFieldFunc", ",", "probePosInBeam", ",", "axesOrder"}], "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"axesOrder", "=", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"iName", "==", "\"\<YZ\>\""}], ",", 
        RowBox[{"axesOrder", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"probeFieldHERE", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"probeField", "[", "iName", "]"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"chosenRepetition", ",", "chosenDetuningIndex"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rotProbe", "[", "plane_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iName", "!=", "\"\<SPHERE\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Chop", "[", 
            RowBox[{
             RowBox[{"Inverse", "[", 
              RowBox[{"RotationMatrix", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"probeNormal", "[", "plane", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}], 
              "]"}], ".", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"probePos", "[", "plane", "]"}], ")"}]}], ",", 
         RowBox[{"probePos", "[", "plane", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"addFunc", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "&"}], ",", "Re"}], "}"}], "[", 
        RowBox[{"[", "probeFieldIntOption", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rotatedProbe", "=", 
       RowBox[{
        RowBox[{"rotProbe", "[", "iName", "]"}], "/", "\[Lambda]0"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"probePolOption", "==", "\"\<x\>\""}], ",", 
        RowBox[{"polIndex", "=", 
         RowBox[{"{", "1", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"probePolOption", "==", "\"\<y\>\""}], ",", 
        RowBox[{"polIndex", "=", 
         RowBox[{"{", "2", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"probePolOption", "==", "\"\<z\>\""}], ",", 
        RowBox[{"polIndex", "=", 
         RowBox[{"{", "3", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"probePolOption", "==", "\"\<total\>\""}], ",", 
        RowBox[{"polIndex", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fieldToPlot", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rotatedProbe", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"axesOrder", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"rotatedProbe", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"axesOrder", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"rotatedProbe", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"axesOrder", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
           RowBox[{"Total", "[", 
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              RowBox[{"addFunc", "[", 
               RowBox[{"probeFieldHERE", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "polIndex"}], "]"}], "]"}], "]"}], "]"}], 
             "2"], " ", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"rotProbe", "[", "iName", "]"}]}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"maxVal", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"fieldToPlot", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxValStep", "=", "2.5"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"idealFieldFunc", "[", "vec_", "]"}], ":=", " ", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"addFunc", "[", 
             RowBox[{"inputBeamPol", "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vec", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ">", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 FractionBox["w0", "w0Ideal"], " ", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", " ", "k0", " ", "z0Ideal"}]], " ", 
                 RowBox[{"gauss", "[", 
                  RowBox[{
                   RowBox[{"vec", " ", "\[Lambda]0"}], ",", "w0Ideal", " ", 
                   ",", "z0Ideal", ",", "\[Lambda]0"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"gauss", "[", 
                 RowBox[{
                  RowBox[{"vec", " ", "\[Lambda]0"}], ",", "w0", " ", ",", 
                  "0", ",", "\[Lambda]0"}], "]"}]}], "\[IndentingNewLine]", 
               "]"}]}], "]"}], "]"}], "2"], ")"}], "[", 
         RowBox[{"[", "polIndex", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"idealLensOption", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"probePosInBeam", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"RotationMatrix", "[", 
                 RowBox[{"{", 
                  RowBox[{"inputBeamDir", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}], 
                ".", "#"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"probePos", "[", "iName", "]"}], ")"}]}], ")"}], "/", 
           "\[Lambda]0"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"idealData", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"rotatedProbe", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"axesOrder", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"rotatedProbe", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"axesOrder", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"rotatedProbe", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"axesOrder", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
              RowBox[{"idealFieldFunc", "[", 
               RowBox[{"probePosInBeam", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"rotProbe", "[", "iName", "]"}]}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"maxVal", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"maxVal", ",", 
              RowBox[{"idealData", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "4"}], "]"}], "]"}]}], "}"}], "]"}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"colorFunc", "=", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Black", ",", "Blue", ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Darker", "@", 
                 RowBox[{"Blend", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Cyan", ",", "Blue"}], "}"}], ",", "0.5"}], 
                  "]"}]}], ","}], "*)"}], 
              RowBox[{"Darker", "@", " ", "Green"}], ",", " ", "Green", ",", 
              " ", "Yellow", ",", " ", "Orange", ",", " ", "Red", ",", 
              RowBox[{"Darker", "@", "Red"}]}], " ", "}"}], ",", "#"}], "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[LessEqual]", "maxValStep"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Blend", "[", 
             RowBox[{
              RowBox[{"{", "  ", 
               RowBox[{
                RowBox[{"Darker", "@", "Red"}], ",", " ", "Purple", ",", " ", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"255", ",", "0", ",", "255"}], "]"}], ",", "Pink", 
                ",", 
                RowBox[{"Lighter", "@", "Pink"}]}], 
               RowBox[{"(*", 
                RowBox[{",", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"255", ",", "51", ",", "102"}], "]"}], ",", 
                 "White"}], "*)"}], "}"}], ",", 
              FractionBox[
               RowBox[{"#", "-", "1"}], 
               RowBox[{"maxValStep", "-", "1"}]]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Blend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Lighter", "@", "Pink"}], ",", "Gray", ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{
                  FractionBox["204", "255"], ",", 
                  FractionBox["153", "255"], ",", 
                  FractionBox["255", "255"]}], "]"}], ",", 
                RowBox[{"RGBColor", "[", " ", 
                 RowBox[{
                  FractionBox["255", "255"], ",", " ", 
                  FractionBox["196", "255"], ",", " ", 
                  FractionBox["255", "255"]}], "]"}], ",", 
                RowBox[{"Lighter", "[", 
                 RowBox[{
                  RowBox[{"RGBColor", "[", " ", 
                   RowBox[{
                    FractionBox["255", "255"], ",", " ", 
                    FractionBox["196", "255"], ",", " ", 
                    FractionBox["255", "255"]}], "]"}], ",", "0.6"}], "]"}], 
                ",", "White"}], 
               RowBox[{"(*", 
                RowBox[{",", " ", "White"}], "*)"}], "}"}], ",", 
              FractionBox[
               RowBox[{"#", "-", "maxValStep"}], 
               RowBox[{"maxVal", "-", "maxValStep"}]]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
        "&"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"iName", "!=", "\"\<SPHERE\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"finalPlot", "=", "\[IndentingNewLine]", 
          RowBox[{"ListDensityPlot", "[", 
           RowBox[{
            RowBox[{"fieldToPlot", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"probeAxisNames", "[", "iName", "]"}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"axesOrder", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
            RowBox[{"ColorFunction", "\[Rule]", "colorFunc"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Atomic Metalens\>\"", ",", 
               RowBox[{"Darker", "[", 
                RowBox[{"Red", ",", "0.2"}], "]"}], ",", "24"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"finalPlot", "=", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListDensityPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"fieldToPlot", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ">", "0"}], "&"}]}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<x/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\"", ",", 
                 "\"\<y/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                "}"}]}], ",", 
              RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
              RowBox[{"ColorFunction", "\[Rule]", " ", "colorFunc"}], " ", 
              ",", 
              RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<Atomic Metalens, z>0\>\"", ",", 
                 RowBox[{"Darker", "[", 
                  RowBox[{"Red", ",", "0.2"}], "]"}], ",", "24"}], "]"}]}], 
              ",", 
              RowBox[{"BoxRatios", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
              RowBox[{"AspectRatio", "\[Rule]", "1"}]}], " ", 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ListDensityPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"fieldToPlot", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "<", "0"}], "&"}]}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<x/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\"", ",", 
                 "\"\<y/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                "}"}]}], ",", 
              RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
              RowBox[{"ColorFunction", "\[Rule]", " ", "colorFunc"}], " ", 
              ",", 
              RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<Atomic Metalens, z<0\>\"", ",", 
                 RowBox[{"Darker", "[", 
                  RowBox[{"Red", ",", "0.2"}], "]"}], ",", "24"}], "]"}]}], 
              ",", 
              RowBox[{"BoxRatios", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
              RowBox[{"AspectRatio", "\[Rule]", "1"}]}], " ", 
             "\[IndentingNewLine]", "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"optionsList", "[", "\"\<probeSPHERE_option\>\"", "]"}], 
            "==", "\"\<FORWARD_HEMISPHERE\>\""}], ",", 
           RowBox[{"finalPlot", "=", 
            RowBox[{"finalPlot", "[", 
             RowBox[{"[", 
              RowBox[{"{", "1", "}"}], "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"optionsList", "[", "\"\<probeSPHERE_option\>\"", "]"}], 
            "==", "\"\<BACKWARD_HEMISPHERE\>\""}], ",", 
           RowBox[{"finalPlot", "=", 
            RowBox[{"finalPlot", "[", 
             RowBox[{"[", 
              RowBox[{"{", "2", "}"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"idealLensOption", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iName", "!=", "\"\<SPHERE\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"idealPlot", "=", 
            RowBox[{"ListDensityPlot", "[", 
             RowBox[{
              RowBox[{"idealData", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"probeAxisNames", "[", "iName", "]"}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"axesOrder", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], "]"}]}], 
              ",", 
              RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
              RowBox[{"ColorFunction", "\[Rule]", "colorFunc"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<Ideal Lens\>\"", ",", 
                 RowBox[{"Darker", "[", 
                  RowBox[{"Red", ",", "0.2"}], "]"}], ",", "24"}], "]"}]}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"finalPlot", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"idealPlot", ",", "\"\<    \>\"", ",", "finalPlot"}], 
              "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"idealPlot", "=", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ListDensityPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Select", "[", 
                  RowBox[{"idealData", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ">", "0"}], "&"}]}], 
                  "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}], 
                ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<x/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\"", 
                   ",", "\"\<y/\!\(\*SubscriptBox[\(\[Lambda]\), \
\(0\)]\)\>\""}], "}"}]}], ",", 
                RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", " ", "colorFunc"}], " ", 
                ",", 
                RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotLabel", "\[Rule]", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<Ideal Lens, z>0\>\"", ",", 
                   RowBox[{"Darker", "[", 
                    RowBox[{"Red", ",", "0.2"}], "]"}], ",", "24"}], "]"}]}], 
                ",", 
                RowBox[{"BoxRatios", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
                RowBox[{"AspectRatio", "\[Rule]", "1"}]}], " ", 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"ListDensityPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Select", "[", 
                  RowBox[{"idealData", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "<", "0"}], "&"}]}], 
                  "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}], 
                ",", 
                RowBox[{"FrameLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<x/\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\"", 
                   ",", "\"\<y/\!\(\*SubscriptBox[\(\[Lambda]\), \
\(0\)]\)\>\""}], "}"}]}], ",", 
                RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", " ", "colorFunc"}], " ", 
                ",", 
                RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotLabel", "\[Rule]", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<Ideal Lens, z<0\>\"", ",", 
                   RowBox[{"Darker", "[", 
                    RowBox[{"Red", ",", "0.2"}], "]"}], ",", "24"}], "]"}]}], 
                ",", 
                RowBox[{"BoxRatios", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", 
                RowBox[{"AspectRatio", "\[Rule]", "1"}]}], " ", 
               "\[IndentingNewLine]", "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"optionsList", "[", "\"\<probeSPHERE_option\>\"", "]"}],
               "==", "\"\<FORWARD_HEMISPHERE\>\""}], ",", 
             RowBox[{"idealPlot", "=", 
              RowBox[{"idealPlot", "[", 
               RowBox[{"[", 
                RowBox[{"{", "1", "}"}], "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"optionsList", "[", "\"\<probeSPHERE_option\>\"", "]"}],
               "==", "\"\<BACKWARD_HEMISPHERE\>\""}], ",", 
             RowBox[{"idealPlot", "=", 
              RowBox[{"idealPlot", "[", 
               RowBox[{"[", 
                RowBox[{"{", "2", "}"}], "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"finalPlot", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"idealPlot", ",", "finalPlot"}], "}"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"styleHereLeg", "=", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "Bold", ",", "Black", ",", "22"}], "]"}], "&"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"legendFunc", "[", "x_", "]"}], ":=", 
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"colorFunc", "[", 
             SuperscriptBox["10", "#"], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{"10", ",", "0.05"}], "]"}], ",", 
               RowBox[{"Log", "[", 
                RowBox[{"10", ",", 
                 RowBox[{"maxVal", "/", "10"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"Log", "[", 
              RowBox[{"10", ",", "maxVal"}], "]"}]}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Bold", ",", "22"}], "]"}]}], ",", 
         RowBox[{"Charting`TicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Bold", ",", 
            RowBox[{"AbsoluteThickness", "[", "2.5", "]"}]}], "]"}]}], ",", 
         RowBox[{"Charting`FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "]"}]}], ",", 
         RowBox[{"Charting`Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Charting`TickLengths", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"8", ",", "5"}], "}"}]}], ",", "\[IndentingNewLine]", " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Ticks", "\[Rule]", 
            RowBox[{"Catenate", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"0.0", ",", 
                  RowBox[{"styleHereLeg", "@", "0.0"}]}], "}"}], "}"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "/", "2"}], "*", "\[Pi]"}], ",", 
                   RowBox[{"styleHereLeg", "[", 
                    RowBox[{
                    RowBox[{"i", "/", "2"}], "*", "\[Pi]"}], "]"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "}"}], 
             "]"}]}], ","}], " ", "*)"}], 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Style", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(log\), \(10\)]\)(\>\"", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"First", "[", 
                RowBox[{"probeFieldIntOption", "/.", 
                 RowBox[{
                 "subsProbeFieldIntOption", "[", "probePolOption", "]"}]}], 
                "]"}], ",", "\"\<)\>\""}], "}"}], "]"}], 
            "\[IndentingNewLine]", ",", "Bold", ",", "Black", ",", "24"}], 
           "]"}]}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "x"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"iName", "!=", "\"\<SPHERE\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
               "finalPlot", ",", "\[IndentingNewLine]", "\"\<    \>\"", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"legendFunc", "[", "320", "]"}]}], "}"}], "]"}], 
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
            "\"\<\>\"", ",", "\"\<\>\"", ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"iName", "==", "\"\<XY\>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<z = \>\"", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#", ",", "Red"}], "]"}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"rotatedProbe", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", " ", 
                   "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                  "}"}], "]"}], ",", "24", ",", "Bold", ",", "Black"}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"iName", "==", "\"\<YZ\>\""}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<x = \>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#", ",", "Red"}], "]"}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"rotatedProbe", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", " ", 
                    "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                    "}"}], "]"}], ",", "24", ",", "Bold", ",", "Black"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"iName", "==", "\"\<XZ\>\""}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<y = \>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#", ",", "Red"}], "]"}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"rotatedProbe", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", " ", 
                    "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                    "}"}], "]"}], ",", "24", ",", "Bold", ",", "Black"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Distance from the center (normal to the plane): \
\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#", ",", "Red"}], "]"}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"rotatedProbe", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", " ", 
                    "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                    "}"}], "]"}], ",", "24", ",", "Bold", ",", "Black"}], 
                   "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Column", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Grid", "[", "finalPlot", "]"}], "\[IndentingNewLine]",
                ",", "\[IndentingNewLine]", "\"\<    \>\"", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"legendFunc", "[", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "optionsList", "[", "\"\<probeSPHERE_option\>\"", "]"}], 
                   "==", "\"\<FULL_SPHERE\>\""}], ",", "700", ",", "320"}], 
                 "]"}], "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", ",", 
            "\"\<\>\"", ",", "\"\<\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<Radius of the probe sphere: \>\"", ",", 
                 RowBox[{
                  RowBox[{"DeleteDuplicates", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"Total", "[", 
                    SuperscriptBox[
                    RowBox[{"Abs", "[", "#", "]"}], "2"], "]"}], "]"}], "&"}],
                     "/@", "rotatedProbe"}], " ", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                 "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(0\)]\)\>\""}], 
                "}"}], "]"}], ",", "24", ",", "Bold", ",", "Black"}], "]"}]}],
            "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Button", "[", 
   RowBox[{
    RowBox[{"bStyle", "@", "\"\<Probe Plots Evaluation\>\""}], ",", 
    RowBox[{"evalTag", "[", "\"\<Probe_Plot_Show\>\"", "]"}], ",", "bSize"}], 
   "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 Editable->False,
 CellOpen->False,
 CellChangeTimes->{{3.8840895877498465`*^9, 3.8840896265901365`*^9}, {
   3.8840903402439365`*^9, 3.884090388784855*^9}, {3.8840904215102215`*^9, 
   3.884090596125465*^9}, {3.8840908765196877`*^9, 3.8840908838266726`*^9}, {
   3.8840910414048786`*^9, 3.8840910489098997`*^9}, {3.884091080065483*^9, 
   3.8840910814465303`*^9}, {3.884091227844818*^9, 3.884091293548526*^9}, {
   3.884091344599633*^9, 3.8840913727552457`*^9}, {3.884091404027721*^9, 
   3.8840915495297055`*^9}, {3.884091582776763*^9, 3.8840916597105646`*^9}, {
   3.8840916907792263`*^9, 3.884091824665047*^9}, {3.884091968282874*^9, 
   3.8840920016069465`*^9}, {3.8840921484937353`*^9, 
   3.8840921682053204`*^9}, {3.8840923585076017`*^9, 3.884092570875697*^9}, {
   3.884092817874975*^9, 3.88409290956091*^9}, {3.884093264254588*^9, 
   3.8840933271994104`*^9}, {3.8840934112375298`*^9, 3.884093537319952*^9}, {
   3.884093576507272*^9, 3.8840936822227745`*^9}, {3.8840938264131346`*^9, 
   3.8840938334162045`*^9}, 3.884093976578696*^9, {3.884094027768428*^9, 
   3.8840940716171865`*^9}, {3.8840941080573907`*^9, 
   3.8840942284068217`*^9}, {3.8840942984467473`*^9, 3.884094301430765*^9}, {
   3.8840943442608976`*^9, 3.884094359567007*^9}, {3.8840946459254436`*^9, 
   3.884094698884159*^9}, {3.8840952381814594`*^9, 3.8840952958330574`*^9}, {
   3.884095831939518*^9, 3.8840959210647416`*^9}, {3.8842621656078434`*^9, 
   3.8842623067395973`*^9}, {3.884262354070858*^9, 3.884262500221032*^9}, {
   3.8842625334977303`*^9, 3.8842625622823277`*^9}, {3.884262754218133*^9, 
   3.8842628084971776`*^9}, {3.884262848601376*^9, 3.884262877723271*^9}, {
   3.884262987267582*^9, 3.88426301389472*^9}, {3.884263048044645*^9, 
   3.8842630650634565`*^9}, {3.8842631076433063`*^9, 
   3.8842631239938936`*^9}, {3.8842631708989058`*^9, 3.884263198554343*^9}, {
   3.8842632974961243`*^9, 3.8842633021311455`*^9}, {3.884263334998002*^9, 
   3.8842633972307167`*^9}, 3.884263487176962*^9, {3.8842635269031577`*^9, 
   3.8842635507506285`*^9}, {3.884263937816327*^9, 3.8842639524651284`*^9}, {
   3.884263985805826*^9, 3.8842640270513678`*^9}, 3.884264058983799*^9, {
   3.884264584993964*^9, 3.884264587562047*^9}, 3.884265071050372*^9, {
   3.8842651295780244`*^9, 3.8842651362678213`*^9}, {3.884267851461569*^9, 
   3.8842678521376057`*^9}, {3.8842680172580743`*^9, 
   3.8842681031231785`*^9}, {3.884268162047867*^9, 3.8842684107636175`*^9}, {
   3.884268611378435*^9, 3.8842686315814533`*^9}, {3.884268663435504*^9, 
   3.8842686635764985`*^9}, {3.8842687062395544`*^9, 
   3.8842687185655785`*^9}, {3.8842687592845907`*^9, 
   3.8842690187700987`*^9}, {3.8842690570791974`*^9, 3.88426917882331*^9}, {
   3.884754621287774*^9, 3.8847546364737253`*^9}, {3.884757161894849*^9, 
   3.8847571659788723`*^9}},
 CellTags->"Probe_Field_Options_2",
 CellLabel->"In[90]:=",ExpressionUUID->"44766579-2671-4ce4-bb84-3f7f8ebd27ab"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"Field or intensity: \"\>",
      StripOnInput->False,
      LineColor->GrayLevel[0],
      FrontFaceColor->GrayLevel[0],
      BackFaceColor->GrayLevel[0],
      GraphicsColor->GrayLevel[0],
      FontSize->15,
      FontWeight->Bold,
      FontColor->GrayLevel[0]], 
     PopupMenuBox[Dynamic[$CellContext`probeFieldIntOptionHere], {1->
      StyleBox["\<\"|E|\\!\\(\\*SuperscriptBox[\\(\\\\ \\), \\(2\\)]\\)\"\>",
       StripOnInput->False,
       LineColor->GrayLevel[0],
       FrontFaceColor->GrayLevel[0],
       BackFaceColor->GrayLevel[0],
       GraphicsColor->GrayLevel[0],
       FontSize->14,
       FontWeight->Bold,
       FontColor->GrayLevel[0]]}]},
    {
     StyleBox["\<\"Ideal lens comparison: \"\>",
      StripOnInput->False,
      LineColor->GrayLevel[0],
      FrontFaceColor->GrayLevel[0],
      BackFaceColor->GrayLevel[0],
      GraphicsColor->GrayLevel[0],
      FontSize->15,
      FontWeight->Bold,
      FontColor->GrayLevel[0]], 
     CheckboxBox[Dynamic[$CellContext`idealLensOptionHere]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxSpacings->{"Columns" -> {{4}}, "Rows" -> {{1}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.8840895364912996`*^9, 3.8840895647182703`*^9}, {
   3.8840896012148275`*^9, 3.884089627582144*^9}, {3.8840902968653984`*^9, 
   3.8840903513540897`*^9}, 3.884090405294041*^9, 3.884090561317297*^9, 
   3.8840906065555296`*^9, 3.884090884519678*^9, {3.8840910512259045`*^9, 
   3.884091081843486*^9}, {3.8840914379367857`*^9, 3.8840914694038987`*^9}, {
   3.884091534422122*^9, 3.8840915501497064`*^9}, 3.8840915903104305`*^9, 
   3.8840916365630155`*^9, 3.8840917565783873`*^9, {3.8840918100864525`*^9, 
   3.88409182515399*^9}, {3.884091970774826*^9, 3.884092002425948*^9}, {
   3.8840921497397366`*^9, 3.8840922343673887`*^9}, 3.884093690785844*^9, 
   3.8840939777936544`*^9, 3.884094016947441*^9, {3.8840940720842667`*^9, 
   3.8840940805392246`*^9}, 3.8840942378979073`*^9, 3.8840943110067425`*^9, 
   3.8840943660189896`*^9, {3.8840946473814116`*^9, 3.88409469925916*^9}, {
   3.884094746688854*^9, 3.884094746769855*^9}, {3.884095006628997*^9, 
   3.8840950067009974`*^9}, 3.8840950763236227`*^9, 3.8840952963820615`*^9, {
   3.8840955945252137`*^9, 3.884095594608243*^9}, {3.8840957394632945`*^9, 
   3.884095739536295*^9}, 3.8840959215146985`*^9, 3.884095971338359*^9, {
   3.8840960283966784`*^9, 3.884096028467671*^9}, {3.8840960907898054`*^9, 
   3.884096090864805*^9}, {3.884262073073301*^9, 3.8842620835790076`*^9}, {
   3.884262223694523*^9, 3.884262245294485*^9}, {3.8842622880476103`*^9, 
   3.8842623071766653`*^9}, 3.8842624673230247`*^9, 3.8842625010920753`*^9, {
   3.8842628852784443`*^9, 3.8842628976574354`*^9}, 3.884263014826213*^9, 
   3.884263065902441*^9, 3.8842631244725904`*^9, {3.8842631808271694`*^9, 
   3.8842631994299355`*^9}, 3.8842633025147204`*^9, 3.8842634879306636`*^9, 
   3.8842635514782405`*^9, 3.884263953776886*^9, 3.884263991108653*^9, 
   3.884264028284935*^9, 3.884264059621374*^9, {3.8842645094638596`*^9, 
   3.884264509538929*^9}, 3.884264587891677*^9, {3.884264993612595*^9, 
   3.884264993747456*^9}, {3.8842651322885237`*^9, 3.8842651370351105`*^9}, 
   3.884267188954054*^9, {3.8842672307272444`*^9, 3.8842672308242426`*^9}, {
   3.8842674225092773`*^9, 3.8842674225703225`*^9}, {3.884267469477339*^9, 
   3.884267469540396*^9}, 3.8842677526717114`*^9, 3.884267854634602*^9, 
   3.88426805720608*^9, 3.8842683709455833`*^9, 3.88426841158364*^9, {
   3.884268557931319*^9, 3.8842685580293756`*^9}, 3.884268632496417*^9, 
   3.884268877339737*^9, {3.8842689195798354`*^9, 3.8842689464078965`*^9}, 
   3.8842689853475*^9, 3.8842690194270988`*^9, {3.8842691495593386`*^9, 
   3.8842691792623434`*^9}, {3.8842693053102894`*^9, 3.88426932931537*^9}, 
   3.8842694340119076`*^9, {3.8842694832549753`*^9, 3.8842694833689723`*^9}, {
   3.884269525103341*^9, 3.8842695321262803`*^9}, {3.884269667348489*^9, 
   3.8842696755804825`*^9}, 3.884269723820853*^9, {3.8844367090087676`*^9, 
   3.8844367400395665`*^9}, {3.884436879054907*^9, 3.8844368791399517`*^9}, 
   3.884690513497989*^9, 3.884753339937924*^9, {3.8847534485083733`*^9, 
   3.8847534485963745`*^9}, {3.8847542475020957`*^9, 3.8847542476240954`*^9}, 
   3.8847546375787277`*^9, {3.88475605692292*^9, 3.884756061966479*^9}, 
   3.8847571665018673`*^9, {3.8847755032084*^9, 3.8847755103484592`*^9}, {
   3.8847819157016883`*^9, 3.8847819238012066`*^9}},
 CellTags->"Probe_Field_Options_2",
 CellLabel->"Out[91]=",ExpressionUUID->"290a6576-36e5-4d43-891f-a04699cd9a3e"],

Cell[BoxData[
 ButtonBox[
  StyleBox["\<\"Probe Plots Evaluation\"\>",
   StripOnInput->False,
   LineColor->GrayLevel[0],
   FrontFaceColor->GrayLevel[0],
   BackFaceColor->GrayLevel[0],
   GraphicsColor->GrayLevel[0],
   FontSize->16,
   FontWeight->Bold,
   FontColor->GrayLevel[0]],
  Appearance->Automatic,
  ButtonFunction:>$CellContext`evalTag["Probe_Plot_Show"],
  Evaluator->Automatic,
  ImageSize->{400, 60},
  Method->"Preemptive"]], "Output",
 CellChangeTimes->{{3.8840895364912996`*^9, 3.8840895647182703`*^9}, {
   3.8840896012148275`*^9, 3.884089627582144*^9}, {3.8840902968653984`*^9, 
   3.8840903513540897`*^9}, 3.884090405294041*^9, 3.884090561317297*^9, 
   3.8840906065555296`*^9, 3.884090884519678*^9, {3.8840910512259045`*^9, 
   3.884091081843486*^9}, {3.8840914379367857`*^9, 3.8840914694038987`*^9}, {
   3.884091534422122*^9, 3.8840915501497064`*^9}, 3.8840915903104305`*^9, 
   3.8840916365630155`*^9, 3.8840917565783873`*^9, {3.8840918100864525`*^9, 
   3.88409182515399*^9}, {3.884091970774826*^9, 3.884092002425948*^9}, {
   3.8840921497397366`*^9, 3.8840922343673887`*^9}, 3.884093690785844*^9, 
   3.8840939777936544`*^9, 3.884094016947441*^9, {3.8840940720842667`*^9, 
   3.8840940805392246`*^9}, 3.8840942378979073`*^9, 3.8840943110067425`*^9, 
   3.8840943660189896`*^9, {3.8840946473814116`*^9, 3.88409469925916*^9}, {
   3.884094746688854*^9, 3.884094746769855*^9}, {3.884095006628997*^9, 
   3.8840950067009974`*^9}, 3.8840950763236227`*^9, 3.8840952963820615`*^9, {
   3.8840955945252137`*^9, 3.884095594608243*^9}, {3.8840957394632945`*^9, 
   3.884095739536295*^9}, 3.8840959215146985`*^9, 3.884095971338359*^9, {
   3.8840960283966784`*^9, 3.884096028467671*^9}, {3.8840960907898054`*^9, 
   3.884096090864805*^9}, {3.884262073073301*^9, 3.8842620835790076`*^9}, {
   3.884262223694523*^9, 3.884262245294485*^9}, {3.8842622880476103`*^9, 
   3.8842623071766653`*^9}, 3.8842624673230247`*^9, 3.8842625010920753`*^9, {
   3.8842628852784443`*^9, 3.8842628976574354`*^9}, 3.884263014826213*^9, 
   3.884263065902441*^9, 3.8842631244725904`*^9, {3.8842631808271694`*^9, 
   3.8842631994299355`*^9}, 3.8842633025147204`*^9, 3.8842634879306636`*^9, 
   3.8842635514782405`*^9, 3.884263953776886*^9, 3.884263991108653*^9, 
   3.884264028284935*^9, 3.884264059621374*^9, {3.8842645094638596`*^9, 
   3.884264509538929*^9}, 3.884264587891677*^9, {3.884264993612595*^9, 
   3.884264993747456*^9}, {3.8842651322885237`*^9, 3.8842651370351105`*^9}, 
   3.884267188954054*^9, {3.8842672307272444`*^9, 3.8842672308242426`*^9}, {
   3.8842674225092773`*^9, 3.8842674225703225`*^9}, {3.884267469477339*^9, 
   3.884267469540396*^9}, 3.8842677526717114`*^9, 3.884267854634602*^9, 
   3.88426805720608*^9, 3.8842683709455833`*^9, 3.88426841158364*^9, {
   3.884268557931319*^9, 3.8842685580293756`*^9}, 3.884268632496417*^9, 
   3.884268877339737*^9, {3.8842689195798354`*^9, 3.8842689464078965`*^9}, 
   3.8842689853475*^9, 3.8842690194270988`*^9, {3.8842691495593386`*^9, 
   3.8842691792623434`*^9}, {3.8842693053102894`*^9, 3.88426932931537*^9}, 
   3.8842694340119076`*^9, {3.8842694832549753`*^9, 3.8842694833689723`*^9}, {
   3.884269525103341*^9, 3.8842695321262803`*^9}, {3.884269667348489*^9, 
   3.8842696755804825`*^9}, 3.884269723820853*^9, {3.8844367090087676`*^9, 
   3.8844367400395665`*^9}, {3.884436879054907*^9, 3.8844368791399517`*^9}, 
   3.884690513497989*^9, 3.884753339937924*^9, {3.8847534485083733`*^9, 
   3.8847534485963745`*^9}, {3.8847542475020957`*^9, 3.8847542476240954`*^9}, 
   3.8847546375787277`*^9, {3.88475605692292*^9, 3.884756061966479*^9}, 
   3.8847571665018673`*^9, {3.8847755032084*^9, 3.8847755103484592`*^9}, {
   3.8847819157016883`*^9, 3.8847819238182583`*^9}},
 CellTags->"Probe_Field_Options_2",
 CellLabel->"Out[93]=",ExpressionUUID->"987a8cc4-a8dd-4b8a-aca0-00565efe1e7c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quiet", "@", 
   RowBox[{"probePlotsFunc", "[", 
    RowBox[{
    "iNameHere", ",", "probePolOptionHere", ",", "probeFieldIntOptionHere", 
     ",", "idealLensOptionHere"}], "]"}]}], "\[IndentingNewLine]"}]], "Input",
 Editable->False,
 CellOpen->False,
 CellChangeTimes->{{3.8840849347710752`*^9, 3.8840849374820776`*^9}, 
   3.8840871333697643`*^9, {3.884087181506901*^9, 3.8840872411936283`*^9}, 
   3.884087348058408*^9, 3.884092037686696*^9, {3.8840955712946587`*^9, 
   3.8840955840316896`*^9}, {3.884263962644548*^9, 3.8842639639714637`*^9}, {
   3.8842672568252783`*^9, 3.884267259838314*^9}},
 CellTags->"Probe_Plot_Show",
 CellLabel->
  "In[103]:=",ExpressionUUID->"d4317a2e-a6a8-49a0-bcd6-806ee3723231"]
}, Open  ]],

Cell[CellGroupData[{

Cell["System Plot", "Chapter",
 CellChangeTimes->{{3.8838229609681473`*^9, 
  3.8838229627639246`*^9}},ExpressionUUID->"54a56419-b958-443d-8a69-\
6610773c91c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"posAtomsChosen", "=", 
    RowBox[{"posAtoms", "[", 
     RowBox[{"[", "chosenRepetition", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"optionsList", "[", "\"\<mirror_symmetry_option\>\"", "]"}], 
      "==", "\"\<YES\>\""}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"posAtomsChosen", "=", 
       RowBox[{"Catenate", "[", 
        RowBox[{"{", 
         RowBox[{"posAtomsChosen", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], "*", "#"}], 
             ")"}], "&"}], "/@", "posAtomsChosen"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"posAtomsChosen", "=", 
       RowBox[{"Catenate", "[", 
        RowBox[{"{", 
         RowBox[{"posAtomsChosen", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", "#"}], ")"}], 
            "&"}], "/@", "posAtomsChosen"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"posAtomsChosen", "=", 
       RowBox[{"DeleteDuplicates", "[", "posAtomsChosen", "]"}]}], ";"}]}], 
    " ", "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xyzRange", "[", "i", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Min", "@", "#"}], ",", 
         RowBox[{"Max", "@", "#"}]}], "}"}], "&"}], "@", 
      RowBox[{"posAtomsChosen", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "i"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"centerZ", "=", 
   RowBox[{"Mean", "[", 
    RowBox[{"xyzRange", "[", "3", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"disksTable", "=", 
   RowBox[{"lensDisksR", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"disksTableNEW", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{"disksTable", ",", "0"}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"funcSystemPlot", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "systemPlot", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"systemPlot", "[", "1", "]"}], "=", 
      RowBox[{"posAtomsChosen", "//", 
       RowBox[{
        RowBox[{"ListPointPlot3D", "[", 
         RowBox[{"#", ",", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"xyzRange", "[", "1", "]"}], "1.3"}], ",", 
             RowBox[{
              RowBox[{"xyzRange", "[", "1", "]"}], "1.3"}], ",", 
             RowBox[{
              RowBox[{"xyzRange", "[", "3", "]"}], "*", "2"}]}], "}"}]}], ",",
           " ", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<x/\[Lambda]0\>\"", ",", " ", "\"\<y/\[Lambda]0\>\"", ",", 
             " ", "\"\<z/\[Lambda]0\>\""}], "}"}]}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", " ",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"systemPlot", "[", "2", "]"}], "=", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"posAtomsChosen", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], "//", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"xyzRange", "[", "1", "]"}], "1.1"}], ",", 
             RowBox[{
              RowBox[{"xyzRange", "[", "1", "]"}], "1.1"}]}], "}"}]}], ",", 
          " ", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<x/\[Lambda]0\>\"", ",", " ", "\"\<y/\[Lambda]0\>\""}], 
            "}"}]}]}], "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", " ", "\[IndentingNewLine]", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"systemPlot", "[", "3", "]"}], "=", 
      RowBox[{"Show", "[", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"posAtomsChosen", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ">", "0"}]}], "&"}]}], "]"}], 
          "//", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"#", ",", 
             RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"xyzRange", "[", "1", "]"}], 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "1.1"}], ",", 
                RowBox[{
                 RowBox[{"xyzRange", "[", "1", "]"}], 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], "1.1"}]}], "}"}]}], ",", 
             " ", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<x/\[Lambda]0\>\"", ",", " ", "\"\<y/\[Lambda]0\>\""}], 
               "}"}]}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", " ", 
                RowBox[{"Cos", "[", "x", "]"}]}], ",", 
               RowBox[{"#", " ", 
                RowBox[{"Sin", "[", "x", "]"}]}]}], "}"}], "&"}], "/@", 
            "disksTable"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", " ", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Red", ",", 
              RowBox[{"Opacity", "[", "0.6", "]"}]}], "]"}]}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<x/\[Lambda]0\>\"", ",", " ", "\"\<y/\[Lambda]0\>\""}], 
             "}"}]}], ",", "\[IndentingNewLine]", " ", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"i", ",", "Bold", ",", "Black", ",", "14"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{
                   RowBox[{"disksTableNEW", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ";;", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}]}], "]"}], "]"}], "//", 
                   "Mean"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "disksTable", "]"}]}], "}"}]}], 
             "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", " ", 
                RowBox[{"Cos", "[", "x", "]"}]}], ",", 
               RowBox[{"#", " ", 
                RowBox[{"Sin", "[", "x", "]"}]}]}], "}"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"disksTable", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"disksTable", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", "bufferRange"}]}], 
             ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", " ", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "@", "Green"}], ",", "Dashed", ",", 
              RowBox[{"Opacity", "[", "0.6", "]"}]}], "]"}]}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<x/\[Lambda]0\>\"", ",", " ", "\"\<y/\[Lambda]0\>\""}], 
             "}"}]}], ",", "\[IndentingNewLine]", " ", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"i", ",", "Bold", ",", "Black", ",", "14"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{
                   RowBox[{"disksTableNEW", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ";;", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}]}], "]"}], "]"}], "//", 
                   "Mean"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "disksTable", "]"}]}], "}"}]}], 
             "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Column", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"systemPlot", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], " ", ",", 
       RowBox[{"Spacings", "\[Rule]", "5"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",
 Editable->False,
 CellOpen->False,
 CellChangeTimes->{{3.883828090930523*^9, 3.883828116164607*^9}, 
   3.883829554893813*^9, {3.883830570212942*^9, 3.8838306326506248`*^9}, {
   3.8838307534405603`*^9, 3.883830758291524*^9}},
 CellTags->"Plots_System",
 CellLabel->
  "In[115]:=",ExpressionUUID->"56b1260e-aaca-4218-b17a-8402fd82ac11"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Button", "[", 
  RowBox[{
   RowBox[{"bStyle", "@", "\"\<System Plots Evaluation\>\""}], ",", " ", 
   RowBox[{
    RowBox[{"evalTag", "[", "\"\<Plots_System\>\"", "]"}], ";", 
    RowBox[{"evalTag", "[", "\"\<Plots_System_Show\>\"", "]"}]}], ",", 
   "bSize", ",", 
   RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]], "Input",
 Editable->False,
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.8838296079600534`*^9, 3.883829621271147*^9}, {
  3.883829753827961*^9, 3.8838297642079716`*^9}, {3.8838297950719895`*^9, 
  3.883829864871138*^9}, {3.883829990676267*^9, 3.883830062858448*^9}, {
  3.883830141861068*^9, 3.883830168806118*^9}, {3.88383023455725*^9, 
  3.8838302347312527`*^9}, {3.8838303447844973`*^9, 3.8838303982245636`*^9}, {
  3.8838304810093813`*^9, 3.8838305488419003`*^9}, {3.8838306171285553`*^9, 
  3.8838306496746817`*^9}, {3.88383069586185*^9, 3.8838307125929346`*^9}, {
  3.883830745897958*^9, 3.8838307461739607`*^9}, {3.884087682694821*^9, 
  3.8840876934678774`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"d6ec61ad-c9e0-4eae-9baf-871eb728297c"],

Cell[BoxData[
 ButtonBox[
  StyleBox["\<\"System Plots Evaluation\"\>",
   StripOnInput->False,
   LineColor->GrayLevel[0],
   FrontFaceColor->GrayLevel[0],
   BackFaceColor->GrayLevel[0],
   GraphicsColor->GrayLevel[0],
   FontSize->16,
   FontWeight->Bold,
   FontColor->GrayLevel[0]],
  Appearance->Automatic,
  ButtonFunction:>($CellContext`evalTag["Plots_System"]; $CellContext`evalTag[
    "Plots_System_Show"]),
  Evaluator->Automatic,
  ImageSize->{400, 60},
  Method->"Queued"]], "Output",
 CellChangeTimes->{{3.883829796844991*^9, 3.8838298710391493`*^9}, {
   3.883830032170394*^9, 3.8838300633034167`*^9}, {3.8838301425630693`*^9, 
   3.8838301695371704`*^9}, 3.8838302353012466`*^9, {3.8838303475054607`*^9, 
   3.8838303776135187`*^9}, 3.8838306503856134`*^9, {3.8838307310979176`*^9, 
   3.8838307481049643`*^9}, 3.8838314190776443`*^9, 3.8838314961614723`*^9, 
   3.8838320611930103`*^9, 3.883893877407485*^9, 3.883894791937619*^9, 
   3.884059178325572*^9, 3.8840795073664713`*^9, 3.8840857830543556`*^9, 
   3.884086109740611*^9, 3.8840865394228935`*^9, 3.88408657904137*^9, {
   3.88408699982583*^9, 3.884087010710843*^9}, 3.8840877016558504`*^9, 
   3.8840949971999807`*^9, 3.884095590205741*^9, 3.8842605120918393`*^9, 
   3.884267182934035*^9, 3.8842672181982136`*^9, 3.8842693006962852`*^9, 
   3.8842694227239046`*^9, 3.8842695172916117`*^9, 3.8844366938257294`*^9, 
   3.884436872678891*^9, 3.884690476250989*^9, 3.8847533378749228`*^9, 
   3.884754234809094*^9, 3.8847560550187488`*^9, 3.8847755017764063`*^9, 
   3.8847819122726893`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"611c68b8-8ac0-4884-9022-0be8a3d066f5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"funcSystemPlot", "[", "]"}]], "Input",
 Editable->False,
 CellOpen->False,
 CellChangeTimes->{{3.883830818009145*^9, 3.8838308184321456`*^9}, {
  3.883896279111*^9, 3.8838962795529566`*^9}},
 CellTags->"Plots_System_Show",
 CellLabel->
  "In[122]:=",ExpressionUUID->"3f2ea4e3-5ae1-46c8-90ab-fa7cdbd30db7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transmission and Reflection", "Chapter",
 CellChangeTimes->{{3.883814960617089*^9, 3.883814966532046*^9}, 
   3.8838229668221407`*^9},ExpressionUUID->"b3b779a1-4663-4d56-8565-\
13950dbd1c28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Button", "[", 
    RowBox[{
     RowBox[{"bStyle", "@", "\"\<Lens Efficiency\>\""}], ",", " ", 
     RowBox[{"evalTag", "[", "\"\<t_and_r_Show\>\"", "]"}], ",", "bSize"}], 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 Editable->False,
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.8838150797927837`*^9, 3.883815356971817*^9}, {
   3.883815400590291*^9, 3.883815807831298*^9}, {3.8838158421072955`*^9, 
   3.883816041175329*^9}, {3.8838161182195387`*^9, 3.883816234759905*^9}, {
   3.883816455131874*^9, 3.883816579779822*^9}, {3.8840605729647503`*^9, 
   3.8840605777647576`*^9}, {3.8840606248512983`*^9, 
   3.8840606545415473`*^9}, {3.884064463918175*^9, 3.884064810012678*^9}, {
   3.8840648618573647`*^9, 3.8840649919137526`*^9}, 3.88406507714253*^9, {
   3.88406510984153*^9, 3.8840651315571356`*^9}, {3.884065163831701*^9, 
   3.88406517668966*^9}, {3.8840652492353597`*^9, 3.8840653073932967`*^9}, {
   3.8840654158454356`*^9, 3.8840654873695326`*^9}, {3.884065519438575*^9, 
   3.884065821230914*^9}, {3.8840659003275976`*^9, 3.8840660653486524`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"d43232c1-b337-4893-b975-f7fc1a875907"],

Cell[BoxData[
 ButtonBox[
  StyleBox["\<\"Lens Efficiency\"\>",
   StripOnInput->False,
   LineColor->GrayLevel[0],
   FrontFaceColor->GrayLevel[0],
   BackFaceColor->GrayLevel[0],
   GraphicsColor->GrayLevel[0],
   FontSize->16,
   FontWeight->Bold,
   FontColor->GrayLevel[0]],
  Appearance->Automatic,
  ButtonFunction:>$CellContext`evalTag["t_and_r_Show"],
  Evaluator->Automatic,
  ImageSize->{400, 60},
  Method->"Preemptive"]], "Output",
 CellChangeTimes->{
  3.884066065940596*^9, 3.884085783092399*^9, 3.884086109777611*^9, 
   3.8840865394558945`*^9, 3.8840865790683804`*^9, {3.8840869998568106`*^9, 
   3.8840870107428493`*^9}, 3.8840949972359724`*^9, 3.8840955902476993`*^9, 
   3.884260512146841*^9, 3.884267182987074*^9, 3.8842672182361703`*^9, 
   3.884269300744336*^9, 3.884269422740923*^9, 3.884269517352663*^9, 
   3.8844366938737316`*^9, 3.884436872694891*^9, 3.8846904762989883`*^9, 
   3.8847533379119244`*^9, 3.884754234843095*^9, 3.8847560550588274`*^9, 
   3.88477550179341*^9, 3.8847819123096223`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"7870a0eb-66e0-4ff8-afa8-8461bd77b61f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fColorHIGH", "=", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"#", ",", "Bold", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", "\[GreaterEqual]", "0.95"}], ",", " ", 
          RowBox[{"Darker", "@", "Green"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[GreaterEqual]", "0.9"}], ",", 
            RowBox[{"Blend", "[", "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "\[GreaterEqual]", "0.8"}], ",", 
              RowBox[{"Darker", "@", "Cyan"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[GreaterEqual]", " ", "0.7"}], ",", "Orange", 
                ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"#", "\[GreaterEqual]", "0.6"}], ",", "Pink", ",", 
                  "Red"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
        "13"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"fColorLOW", "=", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"#", ",", "Bold", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", "\[LessEqual]", " ", "0.5"}], ",", " ", 
          RowBox[{"Darker", "@", "Green"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[LessEqual]", " ", "0.6"}], ",", 
            RowBox[{"Darker", "@", "Cyan"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "\[LessEqual]", "  ", "0.8"}], ",", "Orange", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[LessEqual]", " ", "0.9"}], ",", "Pink", ",", 
                "Red"}], "]"}]}], "]"}]}], "]"}]}], "]"}], ",", "13"}], "]"}],
       "&"}]}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fColorHIGH", "//", "Clear"}], "\[IndentingNewLine]", 
   RowBox[{"fColorLOW", "//", "Clear"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fColorHIGH", "[", 
      RowBox[{
       RowBox[{"val_", "?", "NumberQ"}], ",", 
       RowBox[{"scale_", ":", "1"}]}], "]"}], ":=", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"NumberForm", "[", 
        RowBox[{"val", ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "8"}], "}"}]}], "]"}], ",", "Bold", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"Reverse", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "@", "Green"}], ",", 
            RowBox[{"Darker", "@", "Cyan"}], ",", "Orange", ",", "Red"}], 
           "}"}]}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"val", "-", "0.5"}], "0.5"], "scale"}]}], "]"}], ",", 
       "13"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fColorHIGH", "[", 
     RowBox[{
      RowBox[{"val_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"NumberQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
      RowBox[{"scale_", ":", "1"}]}], "]"}], ":=", "val"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fColorLOW", "[", 
      RowBox[{
       RowBox[{"val_", "?", "NumberQ"}], ",", 
       RowBox[{"scale_", ":", "1"}]}], "]"}], ":=", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"NumberForm", "[", 
        RowBox[{"val", ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "8"}], "}"}]}], "]"}], ",", "Bold", ",", 
       RowBox[{"Blend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Darker", "@", "Green"}], ",", 
           RowBox[{"Darker", "@", "Cyan"}], ",", "Orange", ",", "Red"}], 
          "}"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"val", "-", "0.5"}], "0.5"], "scale"}]}], "]"}], ",", 
       "13"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fColorLOW", "[", 
     RowBox[{
      RowBox[{"val_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"NumberQ", "[", "#", "]"}], "]"}], "&"}], ")"}]}], ",", 
      RowBox[{"scale_", ":", "1"}]}], "]"}], ":=", "val"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tANDrDisplay", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "numApert", ",", "tTargetHere", ",", "nameTarget", ",", "toPrint", 
         ",", "tInHere", ",", "rInHere", ",", "p\[Eta]", ",", "\[Eta]Value", 
         ",", "chosenProbeFieldXY", ",", "probeAreaXY", ",", "pInput", ",", 
         "pOutArray", ",", "pOutFull"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numApert", "=", 
         RowBox[{"nBulk", "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"ArcTan", "[", 
            FractionBox[
             RowBox[{"2.0", "*", "rLens"}], 
             RowBox[{"2", "focalPoint"}]], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tInHere", "=", 
         RowBox[{"tIn", "[", 
          RowBox[{"[", 
           RowBox[{"chosenRepetition", ",", "chosenDetuningIndex"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rInHere", "=", 
         RowBox[{"rIn", "[", 
          RowBox[{"[", 
           RowBox[{"chosenRepetition", ",", "chosenDetuningIndex"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "optionsMetalensList", "[", "\"\<default_target_option\>\"", "]"}],
            "==", "\"\<YES\>\""}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"nameTarget", "=", "\"\<ideal\>\""}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"nameTarget", "=", "\"\<target\>\""}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"toPrint", "=", 
         RowBox[{
         "{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{
                "{", "\"\<\[CapitalGamma]' / \!\(\*SubscriptBox[\(\
\[CapitalGamma]\), \(0\)]\)\>\"", "}"}], "]"}], ",", "Bold", ",", "Black"}], 
              "]"}], ",", "gammaPrime", ",", "\"\<      \>\"", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<Inelastic scattering rate\>\"", ",", "Italic", ",", "Bold",
                ",", "Black"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{
                "{", "\"\<\!\(\*SubscriptBox[\(\[Sigma]\), \(inhom\\\ \
\*SubscriptBox[\(\[Omega]\), \(0\)]\)]\) / \!\(\*SubscriptBox[\(\
\[CapitalGamma]\), \(0\)]\)\>\"", "}"}], "]"}], ",", "Bold", ",", "Black"}], 
              "]"}], ",", "inhomBroad", ",", "\"\<      \>\"", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<St.dev. of the inhomogeneous broadening distribution (0 \
means no broadening)\>\"", ",", "Italic", ",", "Bold", ",", "Black"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\"\<w\>\"", ",", "nameTarget"}], "]"}], ",", 
                  "\"\< / \!\(\*SubscriptBox[\(w\), \(0\)]\)\>\""}], "}"}], 
                "]"}], ",", "Bold", ",", "Black"}], "]"}], ",", 
             RowBox[{"fColorLOW", "[", " ", 
              RowBox[{"w0Target", "/", "w0"}], "]"}], ",", "\"\<      \>\"", 
             ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<Lens magnification\>\"", ",", "Italic", ",", "Bold", ",", 
               "Black"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(n\), \
\(bulk\)]\)sin(arctan(\!\(\*SubscriptBox[\(r\), \(lens\)]\)/f))\>\"", ",", 
                 "Bold", ",", "Black"}], "]"}], ",", " ", 
               RowBox[{"fColorHIGH", "[", 
                RowBox[{"numApert", ",", 
                 RowBox[{"1", "/", "nBulk"}]}], "]"}], ",", "\"\<\>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<Numerical Aperture (NA)\>\"", ",", "Italic", ",", "Bold",
                  ",", "Black"}], "]"}]}], "}"}], ","}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{
                "{", "\"\<\[Epsilon] = \
|\[LeftAngleBracket]\!\(\*SubscriptBox[\(E\), \
\(in\)]\)|E\[RightAngleBracket]|\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\)\>\"", 
                 "}"}], "]"}], ",", "Bold", ",", "Black"}], "]"}], ",", 
             RowBox[{"fColorLOW", "[", 
              SuperscriptBox[
               RowBox[{"Abs", "[", "tInHere", "]"}], "2"], "]"}], ",", 
             "\"\<\>\"", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<Transmission into the input mode\>\"", ",", "Italic", ",", 
               "Bold", ",", "Black"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<|\[LeftAngleBracket]\>\"", ",", 
                  RowBox[{"Subsuperscript", "[", 
                   RowBox[{"\"\<E\>\"", ",", "\"\<in\>\"", ",", "\"\<*\>\""}],
                    "]"}], ",", 
                  "\"\<|E\[RightAngleBracket]|\!\(\*SuperscriptBox[\(\\\ \), \
\(2\)]\) \>\""}], "}"}], "]"}], ",", "Bold", ",", "Black"}], "]"}], ",", 
             RowBox[{"fColorLOW", "[", 
              SuperscriptBox[
               RowBox[{"Abs", "[", "rInHere", "]"}], "2"], "]"}], 
             "\[IndentingNewLine]", ",", "\"\<\>\"", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<Reflection into the input mode\>\"", ",", "Italic", ",", 
               "Bold", ",", "Black"}], "]"}]}], "\[IndentingNewLine]", 
            "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"optionsList", "[", "\"\<target_beam_option\>\"", "]"}], 
           "==", "\"\<YES\>\""}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tTargetHere", "=", 
            RowBox[{"tTarget", "[", 
             RowBox[{"[", 
              RowBox[{"chosenRepetition", ",", "chosenDetuningIndex"}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"toPrint", "=", 
            RowBox[{"Catenate", "@", 
             RowBox[{"{", 
              RowBox[{"toPrint", ",", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\[Eta] = |\[LeftAngleBracket]\>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<E\>\"", ",", "nameTarget"}], "]"}], ",", 
                    "\"\<|E\[RightAngleBracket]|\!\(\*SuperscriptBox[\(\\\ \
\), \(2\)]\) \>\""}], "}"}], "]"}], ",", "Bold", ",", "Black"}], "]"}], ",", 
                   RowBox[{"fColorHIGH", "[", 
                    RowBox[{"\[Eta]Value", "=", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"tTargetHere", "//", "Abs"}], ")"}], "2"]}], 
                    "]"}], ",", "\"\<\>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Transmission into the \>\"", "<>", "nameTarget", 
                    "<>", "\"\< mode\>\""}], "}"}], "\[IndentingNewLine]", 
                    "]"}], ",", "Italic", ",", "Bold", ",", "Black"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(\[Eta]\), \(0\)]\) = |\
\[LeftAngleBracket]\>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<E\>\"", ",", "nameTarget"}], "]"}], ",", 
                    "\"\<|\!\(\*SubscriptBox[\(E\), \(in\)]\)\
\[RightAngleBracket]|\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\) \>\""}], "}"}], 
                    "]"}], ",", "Bold", ",", "Black"}], "]"}], ",", 
                   RowBox[{"fColorLOW", "[", 
                    SuperscriptBox[
                    RowBox[{"Abs", "[", 
                    FractionBox[
                    RowBox[{"2", "  ", "\[Pi]", " ", "w0", " ", "w0Target"}], 
                    RowBox[{
                    RowBox[{"\[Pi]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["w0", "2"], "+", 
                    SuperscriptBox["w0Target", "2"]}], ")"}]}], "+", 
                    RowBox[{
                    "\[ImaginaryI]", " ", "z0Target", " ", "\[Lambda]0"}]}]], 
                    "]"}], "2"], "]"}], ",", "\"\<\>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<Overlap between the input and the \>\"", ",", 
                    "nameTarget", ",", "\"\< modes\>\""}], "}"}], 
                    "\[IndentingNewLine]", "]"}], ",", "Italic", ",", "Bold", 
                    ",", "Black"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
                "}"}]}], "\[IndentingNewLine]", "}"}]}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"optionsList", "[", "\"\<probeXY_option\>\"", "]"}], 
            "==", "\"\<YES\>\""}], "&&", 
           RowBox[{
            RowBox[{"optionsList", "[", "\"\<target_beam_option\>\"", "]"}], 
            "==", "\"\<YES\>\""}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pInput", "=", 
            RowBox[{"\[Pi]", " ", 
             RowBox[{
              SuperscriptBox["w0", "2"], "/", "2"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"p\[Eta]", "=", 
            RowBox[{"\[Eta]Value", " ", "*", "pInput"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"chosenProbeFieldXY", "=", 
            RowBox[{
             RowBox[{"probeField", "[", "\"\<XY\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"chosenRepetition", ",", "chosenDetuningIndex"}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"probeAreaXY", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "#"}], "]"}], 
                 "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Min", "@", "#"}], ",", 
                    RowBox[{"Max", "@", "#"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"probePos", "[", "\"\<XY\>\"", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}]}], 
                ")"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"pOutArray", "=", 
            RowBox[{"probeAreaXY", "*", 
             RowBox[{
              RowBox[{"Total", "[", 
               SuperscriptBox[
                RowBox[{"Abs", "[", "chosenProbeFieldXY", "]"}], "2"], "]"}], 
              "/", 
              RowBox[{"Length", "[", "chosenProbeFieldXY", "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pOutFull", "=", 
            RowBox[{"Total", "[", "pOutArray", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"toPrint", "=", 
            RowBox[{"Catenate", "@", 
             RowBox[{"{", 
              RowBox[{"toPrint", ",", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(P\), \(out\)]\)\>\"", ",", 
                    "\"\</\!\(\*SubscriptBox[\(P\), \(in\)]\) = \>\"", ",", 
                    " ", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<2\[Integral]|\>\"", ",", "\"\<E\>\"", ",", 
                    "\"\<|\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\)dxdy\>\""}], 
                    "}"}], "]"}], ",", "\"\</\>\"", ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\[Pi]\>\"", ",", 
                    RowBox[{"Subsuperscript", "[", 
                    RowBox[{"\"\<w\>\"", ",", "\"\<0\>\"", ",", "\"\<2\>\""}],
                     "]"}], ",", "\"\<)\>\""}], "}"}], "]"}]}], "}"}], 
                    "]"}]}], " ", "}"}], "]"}], ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                   RowBox[{"fColorHIGH", "[", 
                    FractionBox["pOutFull", "pInput"], "]"}], ",", "\"\<\>\"",
                    ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "{", 
                    "\"\<Ratio between the total transmitted power over the \
input power\>\"", "}"}], "\[IndentingNewLine]", "]"}], ",", "Italic", ",", 
                    "Bold", ",", "Black"}], "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subsuperscript", "[", 
                    RowBox[{
                    "\"\<P\>\"", ",", "\"\<out\>\"", ",", "\"\<x\>\""}], 
                    "]"}], ",", 
                    "\"\</\!\(\*SubscriptBox[\(P\), \(in\)]\) = \>\"", ",", 
                    " ", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<2\[Integral]|\>\"", ",", 
                    RowBox[{"CenterDot", "[", 
                    RowBox[{
                    RowBox[{"OverHat", "[", "x", "]"}], ",", "\"\<E\>\""}], 
                    "]"}], ",", 
                    "\"\<|\!\(\*SuperscriptBox[\(\\\ \), \(2\)]\)dxdy\>\""}], 
                    "}"}], "]"}], ",", "\"\</\>\"", ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\[Pi]\>\"", ",", 
                    RowBox[{"Subsuperscript", "[", 
                    RowBox[{"\"\<w\>\"", ",", "\"\<0\>\"", ",", "\"\<2\>\""}],
                     "]"}], ",", "\"\<)\>\""}], "}"}], "]"}]}], "}"}], 
                    "]"}]}], " ", "}"}], "]"}], ",", "Bold", ",", "Black"}], 
                    "]"}], ",", 
                   RowBox[{"fColorHIGH", "[", "\[IndentingNewLine]", 
                    FractionBox[
                    RowBox[{"pOutArray", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "pInput"], "]"}], ",", 
                   "\"\<\>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "{", "\"\<Ratio between the x-polarized, transmitted \
power over the input power\>\"", "}"}], "\[IndentingNewLine]", "]"}], ",", 
                    "Italic", ",", "Bold", ",", "Black"}], "]"}]}], "}"}], 
                 ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{
                    "{", "\"\<\!\(\*SubscriptBox[\(P\), \
\(\[Eta]\)]\)/\!\(\*SubscriptBox[\(P\), \(out\)]\) = (\!\(\*SubscriptBox[\(\
\[Eta]P\), \(in\)]\))/\!\(\*SubscriptBox[\(P\), \(out\)]\)  \>\"", "}"}], 
                    "]"}], ",", "Bold", ",", "Black"}], "]"}], ",", 
                   RowBox[{"fColorHIGH", "[", 
                    RowBox[{
                    FractionBox["pInput", "pOutFull"], "\[Eta]Value"}], "]"}],
                    ",", "\"\<\>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", "\"\<Signal-to-background\>\"", "}"}], 
                    "\[IndentingNewLine]", "]"}], ",", "Italic", ",", "Bold", 
                    ",", "Black"}], "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(P\), \(\[Eta]\)]\)/\>\"", ",", 
                    RowBox[{"Subsuperscript", "[", 
                    RowBox[{
                    "\"\<P\>\"", ",", "\"\<out\>\"", ",", "\"\<x\>\""}], 
                    "]"}], ",", 
                    "\"\< = (\!\(\*SubscriptBox[\(\[Eta]P\), \(in\)]\))/\>\"",
                     ",", 
                    RowBox[{"Subsuperscript", "[", 
                    RowBox[{
                    "\"\<P\>\"", ",", "\"\<out\>\"", ",", "\"\<x\>\""}], 
                    "]"}]}], "}"}], "]"}], ",", "Bold", ",", "Black"}], "]"}],
                    ",", 
                   RowBox[{"fColorHIGH", "[", 
                    RowBox[{
                    FractionBox["pInput", 
                    RowBox[{"pOutArray", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]], "\[Eta]Value"}], "]"}], 
                   ",", "\"\<\>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "{", "\"\<Signal-to-background (only x-polarized \
background)\>\"", "}"}], "\[IndentingNewLine]", "]"}], ",", "Italic", ",", 
                    "Bold", ",", "Black"}], "]"}]}], "}"}]}], 
                "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
              "}"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"toPrint", ",", 
          RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
          RowBox[{"Spacings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"2", ",", " ", "1.3"}], "}"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"tANDrDisplay", "[", "]"}], "\[IndentingNewLine]"}]}]], "Input",
 Editable->False,
 CellOpen->False,
 CellChangeTimes->{{3.884066000192685*^9, 3.884066012532166*^9}, {
   3.884079580423707*^9, 3.8840795921232553`*^9}, {3.884079632393124*^9, 
   3.8840796923294244`*^9}, {3.884079792343252*^9, 3.884079802721819*^9}, {
   3.88407992881411*^9, 3.88407996128998*^9}, {3.8840801172245398`*^9, 
   3.8840801665398674`*^9}, {3.884080230980946*^9, 3.884080267266988*^9}, {
   3.8840803866234465`*^9, 3.8840805054200225`*^9}, {3.8840805521024294`*^9, 
   3.8840807634529715`*^9}, {3.884080842846601*^9, 3.884080856487563*^9}, {
   3.8840809850426135`*^9, 3.8840810363529587`*^9}, {3.88408118599025*^9, 
   3.8840812862942677`*^9}, {3.884081327089587*^9, 3.8840817275491433`*^9}, {
   3.884081760342308*^9, 3.884081785103963*^9}, {3.884081816999777*^9, 
   3.8840824296999893`*^9}, {3.884082516348276*^9, 3.884082517218811*^9}, {
   3.8840851578290567`*^9, 3.8840853358222876`*^9}, 3.8847538456185613`*^9},
 CellTags->"t_and_r_Show",
 CellLabel->"In[95]:=",ExpressionUUID->"a7cf4521-f0f3-4ff5-b8de-78a64647bc02"]
}, Open  ]]
}, Open  ]]
},
PageWidth:>Automatic,
WindowSize->{960, 538},
WindowMargins->{{-5.5, Automatic}, {Automatic, -5.5}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
ShowCellTags->True,
Magnification:>0.7 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"76951a7e-2508-4a15-9016-77d63039f697"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "User_Choice_Folders"->{
  Cell[35607, 911, 2603, 61, 13, "Input",ExpressionUUID->"c62a5f1b-4583-4e58-8f8a-ca35e07611a3",
   CellOpen->False,
   InitializationCell->True,
   CellTags->"User_Choice_Folders"],
  Cell[38213, 974, 1992, 31, 46, "Output",ExpressionUUID->"e2e07a7c-4c1d-442f-94cf-50ed0572071c",
   CellTags->"User_Choice_Folders"]},
 "User_Choice_Data"->{
  Cell[40242, 1010, 6138, 142, 13, "Input",ExpressionUUID->"7fb10386-7b18-47ff-829b-7d36f04d5c83",
   CellOpen->False,
   InitializationCell->True,
   CellTags->"User_Choice_Data"],
  Cell[46383, 1154, 4505, 88, 117, "Output",ExpressionUUID->"8453896c-4bdf-4c16-95d8-e51c5b138656",
   CellTags->"User_Choice_Data"]},
 "Data_Import"->{
  Cell[51206, 1254, 13234, 323, 13, "Input",ExpressionUUID->"925f65a4-5d21-4928-b99b-c52836936a4f",
   CellOpen->False,
   CellTags->"Data_Import"]},
 "User_Choice_Input"->{
  Cell[64465, 1581, 3983, 90, 13, "Input",ExpressionUUID->"eaa9b4e5-630c-4972-9c98-2112d2f76cc5",
   CellOpen->False,
   CellTags->"User_Choice_Input"],
  Cell[68451, 1673, 3183, 56, 38, "Output",ExpressionUUID->"904ba43d-3c2b-4058-86e1-a8a89cc46e1f",
   CellTags->"User_Choice_Input"],
  Cell[71637, 1731, 3025, 53, 38, "Output",ExpressionUUID->"bf46e87c-9b55-43fa-b92f-8ca9056c0794",
   CellTags->"User_Choice_Input"]},
 "Probe_Field_Options"->{
  Cell[78029, 1872, 4575, 113, 13, "Input",ExpressionUUID->"5f02d3f8-521e-4778-ad5d-1e72e1c067f9",
   CellOpen->False,
   CellTags->"Probe_Field_Options"],
  Cell[82607, 1987, 5379, 128, 78, "Output",ExpressionUUID->"6f4674f8-d2ff-4888-a549-aad10e3fd979",
   CellTags->"Probe_Field_Options"]},
 "Probe_Field_Options_2"->{
  Cell[88023, 2120, 44953, 979, 13, "Input",ExpressionUUID->"44766579-2671-4ce4-bb84-3f7f8ebd27ab",
   CellOpen->False,
   CellTags->"Probe_Field_Options_2"],
  Cell[132979, 3101, 4706, 84, 65, "Output",ExpressionUUID->"290a6576-36e5-4d43-891f-a04699cd9a3e",
   CellTags->"Probe_Field_Options_2"],
  Cell[137688, 3187, 3849, 61, 64, "Output",ExpressionUUID->"987a8cc4-a8dd-4b8a-aca0-00565efe1e7c",
   CellTags->"Probe_Field_Options_2"]},
 "Probe_Plot_Show"->{
  Cell[141552, 3251, 749, 16, 13, "Input",ExpressionUUID->"d4317a2e-a6a8-49a0-bcd6-806ee3723231",
   CellOpen->False,
   CellTags->"Probe_Plot_Show"]},
 "Plots_System"->{
  Cell[142501, 3277, 11561, 300, 13, "Input",ExpressionUUID->"56b1260e-aaca-4218-b17a-8402fd82ac11",
   CellOpen->False,
   CellTags->"Plots_System"]},
 "Plots_System_Show"->{
  Cell[156871, 3639, 329, 8, 13, "Input",ExpressionUUID->"3f2ea4e3-5ae1-46c8-90ab-fa7cdbd30db7",
   CellOpen->False,
   CellTags->"Plots_System_Show"]},
 "t_and_r_Show"->{
  Cell[159815, 3711, 26840, 599, 13, "Input",ExpressionUUID->"a7cf4521-f0f3-4ff5-b8de-78a64647bc02",
   CellOpen->False,
   CellTags->"t_and_r_Show"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"User_Choice_Folders", 187216, 4330},
 {"User_Choice_Data", 187558, 4337},
 {"Data_Import", 187893, 4344},
 {"User_Choice_Input", 188067, 4348},
 {"Probe_Field_Options", 188515, 4356},
 {"Probe_Field_Options_2", 188837, 4362},
 {"Probe_Plot_Show", 189297, 4370},
 {"Plots_System", 189468, 4374},
 {"Plots_System_Show", 189644, 4378},
 {"t_and_r_Show", 189816, 4382}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 257, 4, 68, "Title",ExpressionUUID->"9f43ea28-6d05-45db-89a7-4505fd0be62a"],
Cell[840, 28, 161, 3, 37, "Subtitle",ExpressionUUID->"c74474f9-d94d-4d5c-9b16-01fd4f3ddd1d"],
Cell[CellGroupData[{
Cell[1026, 35, 344, 5, 48, "Chapter",ExpressionUUID->"f7d62559-3c4d-43b5-8914-edea640f0ecd"],
Cell[CellGroupData[{
Cell[1395, 44, 795, 12, 46, "Section",ExpressionUUID->"646507d2-7017-46a3-8b0c-fc643ee761cb"],
Cell[2193, 58, 12969, 284, 13, "Input",ExpressionUUID->"25c0bae5-711e-444c-9786-4c2cb5aa7176",
 CellOpen->False,
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[15199, 347, 208, 4, 38, "Section",ExpressionUUID->"46a7c013-6c4a-4345-a39c-7bb9a1c6aa73"],
Cell[15410, 353, 3601, 96, 250, "Input",ExpressionUUID->"9d0503ef-60fc-4993-9648-224850e4d9af",
 InitializationCell->True],
Cell[19014, 451, 228, 4, 21, "Input",ExpressionUUID->"63a28e6b-a612-4f30-9569-5b2f90d7dc32"]
}, Closed]],
Cell[CellGroupData[{
Cell[19279, 460, 184, 3, 38, "Section",ExpressionUUID->"74af3b4b-3b25-49fc-80c4-34fdc569225b"],
Cell[19466, 465, 5236, 148, 13, "Input",ExpressionUUID->"bb5da58a-b9d5-48a9-9c28-99fcb7c4bfbc",
 CellOpen->False,
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[24739, 618, 161, 3, 38, "Section",ExpressionUUID->"44c90393-b743-4a8e-95a8-68038154e1f4"],
Cell[24903, 623, 4968, 129, 307, "Input",ExpressionUUID->"5ebda78a-75d8-4381-8286-140c3b619f94",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[29908, 757, 163, 3, 38, "Section",ExpressionUUID->"3101be78-2858-43f5-b885-21fb78d5ed22"],
Cell[30074, 762, 1066, 27, 87, "Input",ExpressionUUID->"637996a2-38b9-404a-98ca-1ad7c87b4c48",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[31189, 795, 210, 4, 42, "Chapter",ExpressionUUID->"7d40dfd7-06ee-4121-9ae4-cf0efef6cf53"],
Cell[CellGroupData[{
Cell[31424, 803, 476, 12, 13, "Input",ExpressionUUID->"cd89ca5c-c4d2-42ce-8015-e9732f1cdfc8",
 CellOpen->False],
Cell[31903, 817, 686, 22, 55, "Output",ExpressionUUID->"25881e22-4d73-45ed-a201-ad032dfe7829"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32638, 845, 513, 8, 48, "Chapter",ExpressionUUID->"39b225c4-02cb-4d74-b011-07db338dee8a"],
Cell[CellGroupData[{
Cell[33176, 857, 1025, 19, 13, "Input",ExpressionUUID->"ca969745-1461-4bd5-a63b-dbf428306a96",
 CellOpen->False,
 InitializationCell->True],
Cell[34204, 878, 1366, 28, 55, "Output",ExpressionUUID->"9fca46c7-d57b-4103-be8e-95a75040923b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35607, 911, 2603, 61, 13, "Input",ExpressionUUID->"c62a5f1b-4583-4e58-8f8a-ca35e07611a3",
 CellOpen->False,
 InitializationCell->True,
 CellTags->"User_Choice_Folders"],
Cell[38213, 974, 1992, 31, 46, "Output",ExpressionUUID->"e2e07a7c-4c1d-442f-94cf-50ed0572071c",
 CellTags->"User_Choice_Folders"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40242, 1010, 6138, 142, 13, "Input",ExpressionUUID->"7fb10386-7b18-47ff-829b-7d36f04d5c83",
 CellOpen->False,
 InitializationCell->True,
 CellTags->"User_Choice_Data"],
Cell[46383, 1154, 4505, 88, 117, "Output",ExpressionUUID->"8453896c-4bdf-4c16-95d8-e51c5b138656",
 CellTags->"User_Choice_Data"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50937, 1248, 266, 4, 48, "Chapter",ExpressionUUID->"dc01bc8b-ef68-4cd0-8a6e-12d571e5e2ab"],
Cell[51206, 1254, 13234, 323, 13, "Input",ExpressionUUID->"925f65a4-5d21-4928-b99b-c52836936a4f",
 CellOpen->False,
 CellTags->"Data_Import"],
Cell[CellGroupData[{
Cell[64465, 1581, 3983, 90, 13, "Input",ExpressionUUID->"eaa9b4e5-630c-4972-9c98-2112d2f76cc5",
 CellOpen->False,
 CellTags->"User_Choice_Input"],
Cell[68451, 1673, 3183, 56, 38, "Output",ExpressionUUID->"904ba43d-3c2b-4058-86e1-a8a89cc46e1f",
 CellTags->"User_Choice_Input"],
Cell[71637, 1731, 3025, 53, 38, "Output",ExpressionUUID->"bf46e87c-9b55-43fa-b92f-8ca9056c0794",
 CellTags->"User_Choice_Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74711, 1790, 261, 4, 48, "Chapter",ExpressionUUID->"39fc1664-ba47-44c3-a233-4b56ef15cf23"],
Cell[74975, 1796, 3029, 72, 13, "Input",ExpressionUUID->"dc36c839-f4d2-486a-a5de-9081f8daab88",
 CellOpen->False],
Cell[CellGroupData[{
Cell[78029, 1872, 4575, 113, 13, "Input",ExpressionUUID->"5f02d3f8-521e-4778-ad5d-1e72e1c067f9",
 CellOpen->False,
 CellTags->"Probe_Field_Options"],
Cell[82607, 1987, 5379, 128, 78, "Output",ExpressionUUID->"6f4674f8-d2ff-4888-a549-aad10e3fd979",
 CellTags->"Probe_Field_Options"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88023, 2120, 44953, 979, 13, "Input",ExpressionUUID->"44766579-2671-4ce4-bb84-3f7f8ebd27ab",
 CellOpen->False,
 CellTags->"Probe_Field_Options_2"],
Cell[132979, 3101, 4706, 84, 65, "Output",ExpressionUUID->"290a6576-36e5-4d43-891f-a04699cd9a3e",
 CellTags->"Probe_Field_Options_2"],
Cell[137688, 3187, 3849, 61, 64, "Output",ExpressionUUID->"987a8cc4-a8dd-4b8a-aca0-00565efe1e7c",
 CellTags->"Probe_Field_Options_2"]
}, Open  ]],
Cell[141552, 3251, 749, 16, 13, "Input",ExpressionUUID->"d4317a2e-a6a8-49a0-bcd6-806ee3723231",
 CellOpen->False,
 CellTags->"Probe_Plot_Show"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142338, 3272, 160, 3, 48, "Chapter",ExpressionUUID->"54a56419-b958-443d-8a69-6610773c91c7"],
Cell[142501, 3277, 11561, 300, 13, "Input",ExpressionUUID->"56b1260e-aaca-4218-b17a-8402fd82ac11",
 CellOpen->False,
 CellTags->"Plots_System"],
Cell[CellGroupData[{
Cell[154087, 3581, 1123, 21, 13, "Input",ExpressionUUID->"d6ec61ad-c9e0-4eae-9baf-871eb728297c",
 CellOpen->False,
 InitializationCell->True],
Cell[155213, 3604, 1643, 32, 55, "Output",ExpressionUUID->"611c68b8-8ac0-4884-9022-0be8a3d066f5"]
}, Open  ]],
Cell[156871, 3639, 329, 8, 13, "Input",ExpressionUUID->"3f2ea4e3-5ae1-46c8-90ab-fa7cdbd30db7",
 CellOpen->False,
 CellTags->"Plots_System_Show"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157237, 3652, 197, 3, 48, "Chapter",ExpressionUUID->"b3b779a1-4663-4d56-8565-13950dbd1c28"],
Cell[CellGroupData[{
Cell[157459, 3659, 1233, 22, 13, "Input",ExpressionUUID->"d43232c1-b337-4893-b975-f7fc1a875907",
 CellOpen->False,
 InitializationCell->True],
Cell[158695, 3683, 1105, 25, 55, "Output",ExpressionUUID->"7870a0eb-66e0-4ff8-afa8-8461bd77b61f"]
}, Open  ]],
Cell[159815, 3711, 26840, 599, 13, "Input",ExpressionUUID->"a7cf4521-f0f3-4ff5-b8de-78a64647bc02",
 CellOpen->False,
 CellTags->"t_and_r_Show"]
}, Open  ]]
}, Open  ]]
}
]
*)

